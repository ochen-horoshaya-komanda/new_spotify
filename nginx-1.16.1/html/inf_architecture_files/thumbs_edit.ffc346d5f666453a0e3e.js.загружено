!function(t){function e(e){for(var a,o,s=e[0],l=e[1],h=e[2],c=0,u=[];c<s.length;c++)o=s[c],n[o]&&u.push(n[o][0]),n[o]=0;for(a in l)Object.prototype.hasOwnProperty.call(l,a)&&(t[a]=l[a]);for(d&&d(e);u.length;)u.shift()();return r.push.apply(r,h||[]),i()}function i(){for(var t,e=0;e<r.length;e++){for(var i=r[e],a=!0,s=1;s<i.length;s++){var l=i[s];0!==n[l]&&(a=!1)}a&&(r.splice(e--,1),t=o(o.s=i[0]))}return t}var a={},n={"web/thumbs_edit":0},r=[];function o(e){if(a[e])return a[e].exports;var i=a[e]={i:e,l:!1,exports:{}};return t[e].call(i.exports,i,i.exports,o),i.l=!0,i.exports}o.m=t,o.c=a,o.d=function(t,e,i){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},o.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(o.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)o.d(i,a,function(e){return t[e]}.bind(null,a));return i},o.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="/js/cmodules/";var s=window.webpackJsonp=window.webpackJsonp||[],l=s.push.bind(s);s.push=e,s=s.slice();for(var h=0;h<s.length;h++)e(s[h]);var d=l;r.push([217,"bundles/common"]),i()}({217:function(t,e,i){t.exports=i("azUc")},azUc:function(t,e,i){"use strict";i.r(e);i("rE2o"),i("ioFf"),i("rGqo"),i("HEwt"),i("SRfc"),i("a1Th"),i("Btvt"),i("91GP"),i("KKXr");function a(){return(a=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(t[a]=i[a])}return t}).apply(this,arguments)}function n(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(!(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)))return;var i=[],a=!0,n=!1,r=void 0;try{for(var o,s=t[Symbol.iterator]();!(a=(o=s.next()).done)&&(i.push(o.value),!e||i.length!==e);a=!0);}catch(t){n=!0,r=t}finally{try{a||null==s.return||s.return()}finally{if(n)throw r}}return i}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}!window.isMVK&&(window.vkExpand=window.vkExpand||"VK"+(()=>+new Date)(),window.vkUUID=window.vkUUID||0,window.vkCache=window.vkCache||{});var r="doc",o="photo",s="video",l="album",h="market_album",d=1,c=1.777,u=1.5,v=window.isMVK?200:120,p=5,g=6,m=3,f=window.isMVK?604:537,w=window.isMVK?360:343;function b(t,e,i,a){var n={id:t.id,width:intval(e),height:intval(i),lastColumn:a.lastColumn,lastRow:a.lastRow,single:a.single,image:y(t,e,i,a.single),unsized:t.unsized,type:t.type,orig:t};return t.title&&void 0!==t.size?extend(n,{title:t.title,size:t.size}):t.title&&void 0!==t.msize?extend(n,{title:t.title,msize:t.msize}):t.type===s&&t.name&&void 0!==t.name&&extend(n,{name:t.namem}),"number"==typeof t.duration&&(t.duration=formatTime(t.duration)),n.unsized?n.ratio=d:n.ratio=n.image.width/n.image.height,n}function y(t,e,i,a){if(!t)return{};e=intval(e),i=intval(i);var n,o=window.devicePixelRatio||1;if(t.type===s||t.type===r){(t.vid?["x","y","l","s","m"]:["o","z","y","x","m","s","temp"]).forEach(a=>{t.sizes[a]&&(!n||e*o<=t.sizes[a][1]&&i*o<=t.sizes[a][2])&&(n=t.sizes[a])})}else{var l=t.thumb?t.thumb.sizes:t.sizes,h=l.x||l[l.length-1],c=h?(h[1]||1)/(h[2]||1):d,u=0;c>e/i?(u=i,c>1&&(u*=c)):(u=e,c<1&&(u/=c)),i*=o,e*=o;var v=!a&&l.o,p="";p=l.temp?"temp":u<75?"s":u<130?"m":v&&l.o&&l.o[1]>=e&&l.o[2]>=i?"o":v&&l.p&&l.p[1]>=e&&l.p[2]>=i?"p":v&&l.q&&l.q[1]>=e&&l.q[2]>=i?"q":v&&l.r&&l.r[1]>=e&&l.r[2]>=i?"r":"x",n=l[p]}return n[1]=intval(n[1]),n[2]=intval(n[2]),n[1]&&n[2]||(t.unsized=!0),{src:n[0],width:n[1],height:n[2]}}function _(t,e,i){var a;switch(t.type){case r:a=t.ratio;break;case s:a=t.ratio||c;break;case l:case h:a=u;break;default:if(t.sizes&&t.sizes.x){var o=n(t.sizes.x,3),v=o[1],p=o[2];v&&p&&(a=v/p)}if(t.sizes&&t.sizes.temp){var g=n(t.sizes.temp,3),m=g[1],f=g[2];m&&f&&(a=m/f)}}return a||d}function x(t){return!!~[r,o,s,l,h].indexOf(t.toString())}function C(t,e){var i=z(t)||void 0===t.length?{}:[];for(var a in t)(!/webkit/i.test(_ua)||"layerX"!=a&&"layerY"!=a&&"webkitMovementX"!=a&&"webkitMovementY"!=a)&&(e&&"object"==typeof t[a]&&"prototype"!==a&&null!==t[a]?i[a]=C(t[a]):i[a]=t[a]);return i}var z=t=>"[object Object]"===Object.prototype.toString.call(t);function M(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(!(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)))return;var i=[],a=!0,n=!1,r=void 0;try{for(var o,s=t[Symbol.iterator]();!(a=(o=s.next()).done)&&(i.push(o.value),!e||i.length!==e);a=!0);}catch(t){n=!0,r=t}finally{try{a||null==s.return||s.return()}finally{if(n)throw r}}return i}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}window.ThumbsEdit={cache:function(){return cur._thEdCache||(cur._thEdCache={}),cur._thEdCache},loaded:function(){return cur._thEdLoaded||(cur._thEdLoaded={}),cur._thEdLoaded},cur:function(t){function e(){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}(function(){return cur._thEdCur||(cur._thEdCur={}),cur._thEdCur}),getMedias:function(t){var e=[];return(t=ge(t))?((this.cache()[t.id]?this.cache()[t.id].previews:[]).forEach(t=>{this.isValidThumbType(t.type)&&e.push([t.type,`${t.ownerId}_${t.itemId}`])}),e):e},init:function(t,e,i){if(t=ge(t)){(i="boolean"==typeof i?{wide:i}:clone(i)||{}).width&&i.height?i.force=!0:(i.width=t.parentNode.offsetWidth,i.height=Math.round(i.width/1.5));var a=[];e.forEach(t=>{this.isValidThumbType(t.type)&&a.push(t)}),domData(t,"te-inited",1),this.cache()[t.id]={previews:a,opts:i,wide:i.wide,height:0,thumbs:[]};var n=this.cur().timer;n&&clearTimeout(n),a.length?this.cur().timer=setTimeout(()=>{var e=this.processThumbs(i.width,i.height,a,i);this.cache()[t.id].thumbs=e.thumbs,this.cache()[t.id].height=e.height;var n=cf();e.thumbs.forEach((t,e)=>{n.appendChild(this.createThumbEl(t,e))}),val(t,""),toggleClass(t,"wide",i.wide),setStyle(t,{width:e.width,height:e.height}),t.appendChild(n),show(t)},0):(hide(t),val(t,""))}},getParentTooltipCls:function(t){return gpeByClass("_im_text_input",t)?"_im_text_input":"thumb_wrap"},loadAndDisplayImage:function(t,e){if(t&&e&&e.oldImage){var i=new Image,a=e.image,n=e.oldImage;if(this.loaded()[a.src]&&t.src!==a.src)return t.src=a.src,void delete e.oldImage;var r=()=>{t.src===n.src&&(t.src=a.src,delete e.oldImage,this.loaded()[a.src]=!0),removeEvent(i,"load",r)};addEvent(i,"load",r),i.src=a.src}},createThumbEl:function(t,e){if(t&&this.isValidThumbType(t.type)){var i,a=t.oldImage||t.image,n=this.crop(t,t.width,t.height),d=`draggable_thumb _draggable clear_fix${t.unsized?` unsized${t.single?" unsized_single":""}`:""}`,c=`thumb_wrap fl_l thumb_${t.type}_wrap`;switch(t.lastColumn&&(c+=" last_column"),t.lastRow&&(c+=" last_row"),t.height<50&&(c+=" thumb_no_controls"),t.type){case l:case h:t.image.src.match(/^\/images\//)&&(c+=" page_album_nocover"),(t.title||t.thumb)&&(i=`\n            <div class="page_album_title">\n              <div class="page_album_size">${t.msize||t.size}</div>\n              <div class="page_album_title_text">${t.title}</div>\n            </div>\n          `);break;case o:i=`\n          <div class="photo_thumb_btns_container">\n            <div class="photo_thumb_btns_overlay">\n              <div class="photo_thumb_btns">\n                <div class="photo_thumb_btn_show _photo_thumb_btn_show" id="ui_btn_show"></div>\n                ${isPhotoeditor3Available()&&!vk.widget?'<div class="photo_thumb_btn_editor _photo_thumb_btn_editor" id="ui_btn_pe"></div>':""}\n              </div>\n            </div>\n          </div>\n        `;break;case r:i=`\n          ${t.orig.label}\n          <a href="${t.orig.href}" class="post_doc_thumb_link" target="_blank" rel="noopener"></a>\n        `;break;case s:i=t.orig.preview}var u=t.unsized||t.orig.preview?"":`\n      <img class="preview _preview" src="${clean(a.src)}" width="${Math.round(n.width)}" height="${Math.round(n.height)}" style="margin:${n.marginTop}px 0 0 ${n.marginLeft}px;"/>\n    `,v=`\n      <div index="${e}" attachment="${t.id}" class="${c}"${t.name?` aria-label="${clean(t.name)}"`:""} style="width: ${intval(t.width)}px;height: ${intval(t.height)}px;">\n        <div class="${d}" ${t.unsized?` style="background-image:url(${clean(a.src)})"`:""}>\n          ${u}\n          ${i}\n          ${t.type!==s?'<div class="overlay _overlay"></div>':""}\n          <div class="ui_thumb_x_button _close_btn" role="link" aria-label="${clean(getLang("dont_attach"))}">\n            <div class="ui_thumb_x"></div>\n          </div>\n        </div>\n      </div>\n    `,p=se(v),g=geByClass1("_preview",p),m=geByClass1("_draggable",p),f=geByClass1("_close_btn",p);if(t.oldImage&&g&&this.loadAndDisplayImage(g,t),addEvent(m,"click",t=>{if(this.cur().updating||domClosest("_close_btn",t.target))cancelEvent(t);else{var e=gpeByClass("thumb_wrap",t.target),i=this.cache()[e.parentNode.id].previews[e.getAttribute("index")].click;cur.openEditor=hasClass(t.target,"_photo_thumb_btn_editor"),isFunction(i)&&i(t)}}),addEvent(m,"mousedown touchstart",t=>this.startDrag(t)),addEvent(f,"click",t=>{var e=gpeByClass("thumb_wrap",t.target);hide(geByClass1("_draggable",e)),this.removeMedia(e.parentNode.id,e.getAttribute("index"))}),addEvent(f,"mouseover",()=>showTooltip(f,{text:getLang("dont_attach"),shift:[11,8],black:1})),t.type===o){var w=geByClass1("_photo_thumb_btn_show",p);w&&addEvent(w,"mouseover",()=>showTooltip(w,{text:getLang("global_photo_attach_show"),shift:[10,8],black:1,appendParentCls:this.getParentTooltipCls(m)}));var b=geByClass1("_photo_thumb_btn_editor",p);b&&addEvent(b,"mouseover",()=>showTooltip(b,{text:getLang("global_pe_edit"),shift:[9,8],black:1,appendParentCls:this.getParentTooltipCls(m)}))}return p}},getCoords:function(t,e){var i=[];return e=e||getXY(t),Array.from(t.childNodes).forEach(t=>{if(hasClass(t,"thumb_wrap")){var a=getXY(t);i[i.length]={id:t.getAttribute("attachment"),x:intval(a[0]-e[0]),y:intval(a[1]-e[1]),width:intval(t.offsetWidth),height:intval(t.offsetHeight),index:intval(t.getAttribute("index")),node:t}}}),i},startDrag:function(t){var e=t.touches&&1==t.touches.length,i=null==t.button||0!=t.button&&!(1==t.button&&browser.msie8);if(hasClass(t.target,"_photo_thumb_btn_show")||hasClass(t.target,"_photo_thumb_btn_editor"))return cancelEvent(t);if(!(i&&!e||domClosest("_close_btn",t.target)||this.cur().updating)){var a=gpeByClass("draggable_thumb",t.target),n=gpeByClass("editable_thumbs",a),r=this.cache()[n.id];if(r&&!((r.previews||[]).length<2))return this.cur().el=a,this.cur().dragHandler=t=>this.drag(t),this.cur().dropHandler=t=>this.drop(t),addEvent(window,"mousemove touchmove",this.cur().dragHandler),addEvent(window,"mouseup touchend touchcancel",this.cur().dropHandler),e||cancelEvent(t)}},drag:function(t){var e=this.cur().el;if(t.touches&&t.touches.length>1)return this.drop();var i=browser.android?t.touches[0].pageX+(t.pageX||0):t.pageX,a=browser.android?t.touches[0].pageY+(t.pageY||0):t.pageY,n=this.cur();if(hasClass(e,"moving")){var r=i-(n.pos[0]+n.x),o=a-(n.pos[1]+n.y);setStyle(e,{left:r,top:o});var s=n.wpos,l={x:r=n.pos[0]+intval(e.style.marginLeft)+r-s[0],y:o=n.pos[1]+intval(e.style.marginTop)+o-s[1],offsetX:e.offsetWidth,offsetY:e.offsetHeight,index:n.i,node:e},h=!1,d=n.i,c=-1,u=p;each(n.coords,function(t,e){if(t!=n.i&&t!=c){e.offsetX=e.node.offsetWidth+u,e.offsetY=e.node.offsetHeight+u;var i=n.coords[t-1],a=n.coords[t+1],r=l.x+l.offsetX/2,o=l.y+l.offsetY/2,s=e.x+e.offsetX/2,v=e.y+e.offsetY/2,p=e.x+e.offsetX,g=e.y+e.offsetY,m=(i&&i.x==e.x&&i.y!=e.y&&0!=e.y||a&&a.x==e.x&&a.y!=e.y)&&0!=e.x,f=r>=s&&(a&&(r<=a.x+a.offsetX/2&&(a.offsetY==e.offsetY||r<p)||a.y!=e.y)||!a&&l.x<=p)&&o>e.y&&o<g,w=r<s&&r>=e.x&&(!i||i.y!=e.y&&!(i.x==e.x&&!a))&&o>e.y&&o<g,b=m&&o>=v&&o<g&&r>e.x&&r<p,y=m&&o<v&&o>=e.y&&r>e.x&&r<p;f=f&&!m,w=w&&!m&&!f,(f||w||b||y)&&(h=!0,d=e.index<n.i&&(f||b)?e.index+1:l.index<e.index&&(y||w)?e.index-1:e.index),d!=n.i?setStyle(e.node,{left:f?-2:w?2:0,top:b?-2:y?2:0}):setStyle(e.node,{left:0,top:0}),f&&a&&a.y==e.y&&a.x>e.x&&l.index>e.index&&(setStyle(e.node,{left:0,top:0}),setStyle(a.node,{left:2,top:0}),c=t+1),b&&a&&a.x==e.x&&a.y>e.y&&o<=v&&(setStyle(a.node,{left:0,top:0}),c=t+1),y&&i&&i.x==e.x&&i.y<e.y&&o<=v&&(setStyle(i.node,{left:0,top:-2}),setStyle(e.node,{left:0,top:0}))}}),n.to_i=h?d:n.i}else{var g=e.parentNode.parentNode,m=geByClass1("_overlay",e),f=geByClass1("_preview",e),w=intval(e.parentNode.getAttribute("index")),b=this.cache()[g.id].thumbs[w],y=getXY(g),_=getXY(e.parentNode),x=this.getCoords(g,y);n.id=g.id,n.i=w,n.to_i=w,n.x=i-_[0],n.y=a-_[1],n.t=b,n.w=b.width,n.h=b.height,n.pos=_,n.wpos=y,n.crop=this.crop(b,b.width,b.height),n.coords=x;var C=M(this.scale(b.width,b.height,75),2),z=C[0],E=C[1],T=intval((b.width-z)*(browser.mobile?.5:n.x/b.width)),k=intval((b.height-E)*(browser.mobile?.5:n.y/b.height));addClass(e,"moving"),setStyle(e,"zIndex",100);var $={duration:v,transition:Fx.Transitions.easeOutCubic},S=this.crop(b,z,E);animate(e,{opacity:.85,width:z,height:E,marginLeft:T,marginTop:k},$),animate(m,{opacity:1},$),f&&animate(f,S,$)}return cancelEvent(t)},drop:function(t){var e=this.cur();document.removeEventListener("touchmove",this.preventScroll),e.updating=!0;var i=e.el,a=geByClass1("_overlay",i),n=geByClass1("_preview",i);if(removeEvent(window,"mousemove touchmove",e.dragHandler),removeEvent(window,"mouseup touchend touchcancel",e.dropHandler),!hasClass(i,"moving"))return e.updating=!1,cancelEvent(t);if(e.to_i==e.i){var r=e.crop,o={duration:v,transition:Fx.Transitions.easeOutCubic};animate(i,{marginTop:0,marginLeft:0,top:0,left:0,width:e.w,height:e.h,opacity:1},extend(o,{onComplete:()=>{setStyle(i,"zIndex",null),e.updating=!1}})),animate(a,{opacity:0},o),n&&animate(n,r,o)}else{var s=this.cache()[e.id].previews;s=this.move(s,e.i,e.to_i),this.update(e.id,s),isFunction((this.cache()[e.id].opts||{}).onMove)&&this.cache()[e.id].opts.onMove()}return removeClass(i,"moving"),cancelEvent(t)},update:function(t,e){if(t=ge(t)){var i=t.id,a=ge(i),n=this.cache()[a.id],r=n.thumbs,o=n.height,s=n.opts,l=!0===s||!1===s?{wide:s}:clone(s||{}),h=l.width,d=l.height;h&&d?l.force=!0:(h=t.parentNode.offsetWidth,d=Math.round(h/1.5));var c=this.processThumbs(h,d,e,l),u=se(`\n      <div style="height: 0;overflow: hidden;">\n        <div class="_editable_thumbs editable_thumbs${n.wide?" wide":""}" style="width: ${c.width}px;height: ${c.height}px;"></div>\n      </div>\n    `),p=geByClass1("_editable_thumbs",u);c.thumbs.forEach((t,e)=>{p.appendChild(this.createThumbEl(t,e))}),a.parentNode.appendChild(u);var g=this.getCoords(p);each(g,(t,e)=>{for(var i=null,a=this.cur().coords,n=0,o=a.length;n<o;++n)if(a[n].id==e.id){i=a[n];break}if(null!=i){var s=geByClass1("_draggable",i.node),l=geByClass1("_overlay",s),h=geByClass1("_preview",s),d=r[i.index],u=null;each(c.thumbs,(t,e)=>{e.id==d.id&&(this.loaded()[e.image.src]||(e.oldImage=d.image),u=e)}),setStyle(i.node,{left:0,top:0}),i.height==e.height&&i.width==i.width&&e.x==i.x&&e.y==i.y&&i.index!=this.cur().i||(hasClass(s,"moving")&&fadeOut(l,v),setTimeout(()=>{animate(s,{top:e.y-i.y,left:e.x-i.x,marginLeft:0,marginTop:0,height:e.height,width:e.width,opacity:1},v);var t=this.crop(u,e.width,e.height);h&&animate(h,t,v),toggleClass(s,"unsized_single",u.unsized&&u.single)},4))}}),o!=c.height&&setTimeout(()=>{animate(a,{height:c.height},v)},4),setTimeout(()=>{isFunction(l.onUpdate)&&l.onUpdate(),setStyle(a,{height:c.height,width:c.width}),a.innerHTML="",this.cache()[i].thumbs=c.thumbs,this.cache()[i].previews=e,this.cache()[i].height=c.height,c.thumbs.forEach((t,e)=>{a.appendChild(this.createThumbEl(t,e))}),re(u),this.cur().updating=!1},v)}},setWide:function(t,e,i){if(t=ge(t)){var a=this.cache()[t.id],n=clone(i||{});void 0===e&&(e=!1),n.wide=e,a.wide!=e&&this.init(t,a.previews,n)}},hasMedia:function(t,e){if(t=ge(t)){var i=t.id,a=this.cache()[i];if(a){for(var n=0;n<a.previews.length;n++)if(a.previews[n][a.previews[n].type].id==e)return!0;return!1}}},addMedia:function(t,e){if((t=ge(t))&&e){var i=t.id,a=this.cache()[i];if(a){var n=clone(a.previews);10==n.length||this.hasMedia(t,e[e.type].id)||(n[n.length]=e,this.cache()[i]=null,this.init(i,n,clone(a.opts)))}}},updateMedia:function(t,e,i,a){if((t=ge(t))&&e&&i&&a){var n=t.id,r=this.cache()[n];if(r){for(var o=clone(r.previews),s=!1,l=e+i,h=0;h<o.length;h++)if(o[h][o[h].type].id==l){var d=this.convert(e,i,a.editable);o[h]=d,s=!0;break}s&&(this.cache()[n]=null,this.init(n,o,clone(r.opts)))}}},refresh:function(t){if(t=ge(t)){var e=t.id,i=this.cache()[e];i&&(this.cache()[e]=null,this.init(e,clone(i.previews),clone(i.opts)))}},removeAll:function(t){if(t=ge(t)){var e=t.id,i=this.cache()[e];i&&(this.cache()[e]=null,this.init(e,[],i.opts))}},removeMedia:function(t,e){if(!(t=ge(t)))return null;e=intval(e);var i=this.cache()[t.id];if(i){var a=i.previews.splice(e,1),n=a[0][a[0].type].id;return each(t.childNodes,(t,e)=>{if(e.getAttribute&&e.getAttribute("attachment")==n){var i=(geByClass1("_close_btn",e)||{}).tt;i&&i.destroy&&i.destroy()}}),this.cur().coords=this.getCoords(t),0==i.previews.length?this.init(t,[],i.opts):this.update(t,i.previews),a[0]&&a[0].remove&&a[0].remove(),a}},removeById:function(t,e){if(!(t=ge(t)))return null;for(var i=(this.cache()[t.id]||{}).previews||[],a=0,n=i.length;a<n;++a)if(i[a].type==r&&i[a].doc.id==e||i[a].type==o&&i[a].photo.id==e||i[a].type==s&&i[a].video.id==e||i[a].type==l&&i[a].album.id==e||i[a].type==h&&i[a].market_album.id==e)return this.removeMedia(t,a);return null},processThumbs:function(t,e,i,a){var n=function(t){var e=0;return each(t,(t,i)=>{e+=i}),e},r=function(t,e,i){return(e-(t.length-1)*i)/n(t)},o=(a=z(a)?a:{}).wide,l=[],h=0,d=[],c=[];each(i,(t,e)=>{x(e.type)&&(d[d.length]=e[e.type]),e.type===s&&l.push(h),h++});var u="",v=[],y=d.length;each(d,(i,a)=>{var n=_(a,t,e);u+=n>1.2?"w":n<.8?"v":"q",v[v.length]=n});var M,E,T=v.length>0?n(v)/v.length:1,k=p;window.isMVK&&(k=window.innerWidth>=480?g:m);var $=k;a.force?(M=t,E=e):(o?(M=f,E=w):t>=381?(M=381,E=1==y?361:237):(M=337,E=1==y?320:214),t<M&&(M=t,E=e),window.isMVK&&(M=Math.min(f,window.innerWidth),E=Math.min(w,M)));var S=M/E,O=0,I=0;if(1==y){var R={lastColumn:1,lastRow:1,single:1};d[0].thumb?(O=279,I=185):v[0]>=1*S?(O=M,I=Math.min(O/v[0],E)):(I=E,O=Math.min(I*v[0],M));var j=b(d[0],O,I,R);!j.unsized&&(j.image.width<O&&j.image.height<=E||j.image.height<I&&j.image.width<=M)&&(O=j.image.width,I=j.image.height,j=b(d[0],O,I,R)),c[0]=j}else if(2==y){var B,A;switch(u){case"ww":if(T>1.4*S&&v[1]-v[0]<.2){A=M,B=Math.min(A/v[0],A/v[1],(E-$)/2),c[0]=b(d[0],A,B,{lastColumn:1}),c[1]=b(d[1],A,B,{lastColumn:1,lastRow:1}),O=M,I=2*B+$;break}case"vv":case"qv":case"vq":case"qq":A=(M-k)/2,B=Math.min(A/v[0],A/v[1],E),c[0]=b(d[0],A,B,{lastRow:1}),c[1]=b(d[1],A,B,{lastRow:1,lastColumn:1}),O=M,I=B;break;default:var P=intval((M-k)/v[1]/(1/v[0]+1/v[1])),X=M-P-k;B=Math.min(E,P/v[0],X/v[1]),c[0]=b(d[0],P,B,{lastRow:1}),c[1]=b(d[1],X,B,{lastColumn:1,lastRow:1}),O=M,I=B}}else if(3==y)if((v[0]>1.2*S||T>1.5*S)&&"www"==u){var Y,L=M,H=Math.min(L/v[0],.66*(E-$));if(c[0]=b(d[0],L,H,{lastColumn:1}),"www"==u){var N=intval(M-k)/2;Y=Math.min(E-H-$,N/v[1],N/v[2]),c[1]=b(d[1],N,Y,{lastRow:1}),c[2]=b(d[2],M-N-k,Y,{lastColumn:1,lastRow:1})}else{var V=intval((M-k)/v[2]/(1/v[1]+1/v[2])),q=M-V-k;Y=Math.min(E-H-$,V/v[2],q/v[1]),c[1]=b(d[1],V,Y,{lastRow:1}),c[2]=b(d[2],V,Y,{lastRow:1,lastColumn:1})}O=M,I=H+Y+$}else{var K=E,D=intval(Math.min(K*v[0],.75*(M-k)));c[0]=b(d[0],D,K,{lastRow:1});var U=v[1]*(E-$)/(v[2]+v[1]),W=E-U-$,F=Math.min(M-D-k,intval(U*v[2]),intval(W*v[1]));c[1]=b(d[1],F,W,{lastColumn:1}),c[2]=b(d[2],F,U,{lastColumn:1,lastRow:1}),O=D+F+k,I=E}else if(4==y)if((v[0]>1.2*S||T>1.5*S)&&"wwww"==u){var G=M,J=Math.min(G/v[0],.66*(E-$));c[0]=b(d[0],G,J,{lastColumn:1});var Q=(M-2*k)/(v[1]+v[2]+v[3]),Z=intval(Q*v[1]),tt=intval(Q*v[2]),et=G-Z-tt-2*k;Q=Math.min(E-J-$,Q),c[1]=b(d[1],Z,Q,{lastRow:1}),c[2]=b(d[2],tt,Q,{lastRow:1}),c[3]=b(d[3],et,Q,{lastColumn:1,lastRow:1}),O=M,I=J+Q+$}else{var it=E,at=Math.min(it*v[0],.66*(M-k)),nt=(E-2*$)/(1/v[1]+1/v[2]+1/v[3]),rt=intval(nt/v[1]),ot=intval(nt/v[2]),st=it-rt-ot-2*$;at+(nt=Math.min(M-at-k,nt))+k<M&&it*v[0]>at&&(at=Math.min(it*v[0],M-k-nt)),c[0]=b(d[0],at,it,{lastRow:1}),c[1]=b(d[1],nt,rt,{lastColumn:1}),c[2]=b(d[2],nt,ot,{lastColumn:1}),c[3]=b(d[3],nt,st,{lastColumn:1,lastRow:1}),O=at+nt+k,I=E}else{var lt=[],ht=0;T>(l.length?1.3:1.1)?each(v,(t,e)=>{lt[lt.length]=Math.max(1,e)}):each(v,(t,e)=>{~l.indexOf(ht)?lt[lt.length]=e:lt[lt.length]=Math.min(1,e),ht++});var dt,ct,ut={};for(ut[y+""]=[r(lt,M,k)],dt=1;dt<=y-1;dt++)ut[dt+","+(ct=y-dt)]=[r(lt.slice(0,dt),M,k),r(lt.slice(dt),M,k)];for(dt=1;dt<=y-2;dt++)for(ct=1;ct<=y-dt-1;ct++)ut[dt+","+ct+","+(y-dt-ct)]=[r(lt.slice(0,dt),M,k),r(lt.slice(dt,dt+ct),M,k),r(lt.slice(dt+ct),M,k)];var vt,pt=null,gt=0;for(var mt in ut)if(ut.hasOwnProperty(mt)){var ft=ut[mt],wt=n(ft)+$*(ft.length-1),bt=Math.abs(wt-E);if(~mt.indexOf(",")){for(var yt=mt.split(","),_t=0;_t<yt.length;_t++)yt[_t]=intval(yt[_t]);(yt[0]>yt[1]||yt[2]&&yt[1]>yt[2])&&(bt+=50,bt*=1.5)}(null===pt||bt<gt)&&(pt=mt,gt=bt,vt=wt)}for(var xt=C(d),Ct=C(lt),zt=pt.split(","),Mt=ut[pt],Et=zt.length-1,Tt=0;Tt<zt.length;Tt++){var kt=parseInt(zt[Tt]),$t=xt.splice(0,kt),St=Mt.shift(),Ot=$t.length-1,It={};Et==Tt&&(It.lastRow=!0);for(var Rt=M,jt=0;jt<$t.length;jt++){var Bt=$t[jt],At=Ct.shift(),Pt=It,Xt=void 0;Ot==jt?(Xt=Math.ceil(Rt),Pt.lastColumn=!0):Rt-=(Xt=intval(At*St))+k,c[c.length]=b(Bt,Xt,St,Pt)}}O=M,I=vt}return{width:intval(O),height:intval(I),thumbs:c}},compute:b,getSize:y,move:function(t,e,i){if(i>=t.length)for(var a=i-t.length;1+a--;)t.push(void 0);return t.splice(i,0,t.splice(e,1)[0]),t},scale:function(t,e,i,a){i=intval(i),a=intval(a)||i;var n=t,r=e;return t>=e&&t>i?(n=intval(i),r=intval(e/(t/i))):t<e&&e>a&&(r=intval(a),n=intval(t/(e/a))),[n,r]},crop:function(t,e,i){var a=e,n=i,r=0,o=0;if(!t.vid&&t.image.width&&t.image.height){var s=t.image.width/t.image.height;s<e/i?(t.single&&t.image.width<e&&(e=t.image.width,i=Math.min(i,t.image.height)),(n=(a=e)/s)>i&&(o=-intval((n-i)/2))):(t.single&&t.image.height<i&&(i=t.image.height,e=Math.min(e,t.image.width)),(a=(n=i)*s)>e&&(r=-intval((a-e)/2)))}return{width:a,height:n,marginLeft:r,marginTop:t.orig&&(t.type===h||t.type===l)&&t.single?0:o}},getRatio:_,convert:function(t,e,i,d){var c=n(e.split("_"),2),u=c[0],v=c[1],p=a({owner_id:u,ownerId:u,itemId:v,type:t,remove:i.remove,click:i.click,temp:"temp"in i.sizes},d);switch(t){case r:p.data={sizes:i.sizes,ratio:i.ratio,label:i.label,href:i.href},p.doc=p.data;break;case o:p.data={pid:v,sizes:i.sizes},p.photo=p.data;break;case s:p.data={vid:v,duration:i.duration,platform:i.platform,play_icon:i.play_icon,preview:i.preview,active_live:i.active_live,restriction:i.restriction,ratio:i.ratio,sizes:i.sizes,name:i.name},p.video=p.data;break;case l:p.data={aid:v,title:i.title,size:i.size,thumb:{sizes:i.sizes}},p.album=p.data;break;case h:p.data={type:h,aid:v,title:i.title,msize:i.msize,thumb:{sizes:i.sizes}},p.market_album=p.data}return p.data.type=t,p.data.id=p.temp?`${t}temp_${u}`:`${t}${p.ownerId}_${p.itemId}`,p},isValidThumbType:x};try{stManager.done(jsc("web/thumbs_edit.js"))}catch(t){}}});