(window.webpackJsonp=window.webpackJsonp||[]).push([["bundles/d14210db89a37ef97acca2f934f28b98"],{rwc4:function(__webpack_module__,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"searcher",function(){return searcher}),__webpack_require__.d(__webpack_exports__,"iSearch",function(){return iSearch});var core_js_modules_es6_regexp_match__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("SRfc"),_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("t7n3"),_web_lib_stats__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("XzvV"),_web_lib_debug_tools__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("98sY"),_web_lib_dom__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("zxIV"),searcher={getSectionParams(e){var s=ge("filter_form"),r={};for(var t in(r=!s||e&&e!==cur.section||"quick"===cur.section?{"c[section]":e||cur.section}:Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_1__.serializeForm)(s)||{})["c[q]"]=val("search_query"),r)r.hasOwnProperty(t)&&(r[t]&&"0"!=r[t]||delete r[t],"-1"==r[t]&&r[`${t}_custom`]?(r[t]=r[`${t}_custom`],delete r[`${t}_custom`]):r[`${t}_custom`]&&delete r[`${t}_custom`]);return"video"!==cur.section||r["c[sort]"]||(r["c[sort]"]="0"),"people"===cur.section&&ge("photo")&&!r["c[photo]"]&&(r["c[photo]"]="0"),"people"===cur.section&&r["c[invite]"]&&delete r.from,"communities"!==cur.section||!cur.filtersShown||r["c[q]"]||r["c[category]"]||(r["c[skip_catalog]"]="1"),r},sameParams(e){if(!cur.params)return!1;for(var s in e)if(e.hasOwnProperty(s)&&e[s]!=cur.params[s])return!1;for(var r in cur.params)if(cur.params.hasOwnProperty(r)&&e[r]!=cur.params[r])return!1;return!0},switchSection(e,s,r){if(r&&checkEvent(r))return!0;Object(_web_lib_stats__WEBPACK_IMPORTED_MODULE_2__.removeSearchPositionTracker)("search_video"),Object(_web_lib_stats__WEBPACK_IMPORTED_MODULE_2__.removeSearchPositionTracker)("search_audio"),Object(_web_lib_stats__WEBPACK_IMPORTED_MODULE_2__.removeSearchPositionTracker)("friends_find"),Object(_web_lib_stats__WEBPACK_IMPORTED_MODULE_2__.removeSearchPositionTracker)("search_people"),Object(_web_lib_stats__WEBPACK_IMPORTED_MODULE_2__.removeSearchPositionTracker)("search_communities"),Object(_web_lib_stats__WEBPACK_IMPORTED_MODULE_2__.removeSearchPositionTracker)("search_auto"),s=s||{},"communities"===e&&(val("c[category]",0),cur.filtersShown=!1);var t=searcher.getSectionParams(e);if("auto"!==e&&"quick"!==e&&s.updateStats&&(t.swt=1),s.tab&&(t.tab=1),ge("search_menu")&&uiRightMenu){var c=geByClass1(`search_menu_${e}`,"search_menu");c&&uiRightMenu.switchMenu(c)}return searcher.setSection(e),searcher.sendSearchReq(t,!0),hasClass(gpeByClass("ui_search","search_query"),"ui_search_fixed")&&scrollToTop(),!1},switchAudioTop(e){return cur.useRec=e,cur.audioTop=e,this.switchSection("audio")},showMedia:(e,s,r)=>(!r||!checkEvent(r))&&(hide(geByClass1("label",s)),show(geByClass1("progress",s)),cur.loadingMedia=!0,searcher.switchSection(e,{updateStats:!0},r)),updResults(){if(cur.customSearchChange)return cur.customSearchChange(),!1;var e=searcher.getSectionParams();if(searcher.sameParams(e)||"video"===e["c[section]"]&&!e["c[q]"]&&!nav.objLoc["c[q]"])return!1;cur.onSearchChange&&cur.onSearchChange(e),searcher.sendSearchReq(e,("auto"===cur.section||"audio"===cur.section&&e["c[q]"]&&!ge("audio_lyrics_filter")||"audio"===cur.section&&!e["c[q]"]&&ge("audio_lyrics_filter"))&&!e.offset),hasClass(gpeByClass("ui_search","search_query"),"ui_search_fixed")&&scrollToTop()},onInputChange(e){clearTimeout(cur.requestTimeout),!e||"keydown"===e.type&&13!==e.keyCode?cur.requestTimeout=setTimeout(()=>{searcher.updResults()},1e3):searcher.updResults()},onKey(){"quick"===cur.section&&(clearTimeout(cur.requestTimeout),cur.requestTimeout=setTimeout(()=>{searcher.updResults()},300))},onEnter(e,s){var r=window.iSearch;r&&r.select&&r.select.isVisible()&&r.select.active>-1||(clearTimeout(cur.requestTimeout),searcher.updResults(),searcher.highlightHotHashtag(s))},checkbox(e,s,r,t){checkbox(e);var c=isChecked(e)?1:0;r&&(c=1-c),val(s,c),t||searcher.updResults()},sendSearchReq(e,s){if(cur.searchReq)try{cur.searchReq.abort()}catch(e){debugLog(e)}s&&!e.offset&&(vk.no_ads=inArray(e["c[section]"],["audio"]),extend(e,{uf:1})),void 0!==cur.useRec&&(e.rec=cur.useRec,delete cur.useRec),e.edit=nav.objLoc.edit,e.sign=nav.objLoc.sign,e.all=nav.objLoc.all,e.change=1,cur.searchLoc&&(e.search_loc=cur.searchLoc),void 0!==cur.topType&&(e.type=cur.topType,delete cur.topType);var r=window.iSearch;r&&r.select&&(r.select.hide(),delete cur.setISearch),cur.loadingMedia||(uiSearch.showProgress("search_query"),ge("search_query").ignoreFixed="statuses"==e["c[section]"]);var t=+new Date;cur.searchReq=ajax.post("al_search.php",e,{onDone(r,c,i){var a=e.uf&&ge("results_wrap")?ge("results_wrap"):ge("results"),o=ge("friends_filters_block")?ge("friends_filters_block"):ge("filter_form");if(a.innerHTML=c||"",s&&(o.innerHTML=i||"",elfocus("search_query"),r.loc)){var n=`${locProtocol}//${location.host}/${r.loc}`,l=document.URL===n?"":document.URL;setTimeout(updateOtherCounters.pbind(n,l),10)}searcher.applyOptions(r,s),uiSearch.hideProgress("search_query"),show("search_clear_params");var u=window.audioPlayer;u&&u.showCurrentTrack&&u.showCurrentTrack(),cur.onSearchFinish&&cur.onSearchFinish(),shortCurrency(),setTimeout(checkPageBlocks,200),cur.onSearchDone&&cur.onSearchDone(),Object(_web_lib_stats__WEBPACK_IMPORTED_MODULE_2__.saveSearchAttemptStats)("friends"===cur.module?"friends_find":`search_${cur.section}`,t,!isVisible(ge("no_results")),e["c[q]"],0,r.experiment_bits)},onFail:()=>(uiSearch.hideProgress("search_query"),!0),showProgress(){addClass(ge(`filter_${cur.section}`),"loading"),cur.isSearchLoading=!0},hideProgress(){removeClass(ge(`filter_${cur.section}`),"loading"),cur.isSearchLoading=!1,cur.loadingMedia=!1},ads:!(!s||e.offset)})},setSection(e){e!==cur.section&&"auto"!==e&&e&&(cur.section=e)},applyOptions(options,changeSection){var iSearch=window.iSearch;iSearch.initSelect(),searcher.setSection(options.section),options.reply_names&&(extend(cur.options.reply_names,options.reply_names),delete options.reply_names),extend(cur,options),cur.params=searcher.getSectionParams();var header=ge("search_header");if(options.tabs)val("search_tabs_wrap",options.tabs),hide(header),show("search_tabs_wrap");else if(options.title){var headerInner=geByClass1("_header_inner",header);val(headerInner,options.title),options.summary&&headerInner.appendChild(ce("span",{className:"page_block_header_count",innerHTML:langNumeric(options.summary,"%s",!0)})),hide("search_tabs_wrap"),show(header)}if(null!=options.controls&&val(geByClass1("_header_extra",header),options.controls||""),void 0!==options.auto_rows&&ge("search_auto_rows")&&(ge("search_auto_rows").innerHTML=options.auto_rows||""),clearTimeout(cur.setLocTO),options.loc)if(changeSection)try{nav.setLoc(options.loc)}catch(e){debugLog(e)}else cur.setLocTO=setTimeout(()=>{if("search"===nav.objLoc[0]||"communities"===nav.objLoc[0]||"brands"===nav.objLoc[0]||nav.objLoc[0].match(/^people($|\/)/)||cur.searchLoc)try{nav.setLoc(options.loc)}catch(e){debugLog(e)}},100);if(options.htitle&&setDocumentTitle(replaceEntities(stripHTML(options.htitle))),void 0!==options.q){val("search_query",replaceEntities(stripHTML(options.q))||"");var resetEl=ge("search_clear_params");resetEl&&show(resetEl)}if(cur.uiSort&&void 0!==options.sortHide&&(options.sortHide&&cur.uiSort.selectItem(0,!1),cur.uiSort.disable(options.sortHide)),"auto"===cur.section&&show(geByClass1("search_menu_auto","search_menu")),options.script)try{eval(options.script)}catch(e){Object(_web_lib_debug_tools__WEBPACK_IMPORTED_MODULE_3__.logEvalError)(e,options.script)}var res=ge("results"),sc=ge("search_content"),lighted=hasClass(sc,"highlight");res.className=`search_results search_${cur.section}_results${"statuses"===cur.section||"auto"===cur.section?" wall_module":""}${"statuses"===cur.section&&""!==options.summary||gpeByClass("page_block",res)?"":" page_block"} mark_top_verified`,"audio"===cur.section&&(res.className+=" audio_w_covers"),lighted&&addClass(sc,"highlight");var moreResults=ge("search_more_results");cur.has_more||moreResults&&moreResults.firstChild?(hide("seach_pages"),show("ui_search_load_more")):hide("ui_search_load_more")},selectHotHashtag(e){var s=val(e),r=ge("search_query"),t=(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_4__.data)(r,"opts")||{}).onEnter;return val(r,s),t&&t(r,s),statlogsValueEvent("top_hashtag_search",0,"click"),!1},highlightHotHashtag(e){e=e?e.toLowerCase():"";var s=!1,r=geByClass("search_hot_hashtags_item","search_hot_hashtags");return each(r,(r,t)=>{val(t).toLowerCase()===e?(s=!0,addClass(t,"search_hot_hashtags_item_active")):removeClass(t,"search_hot_hashtags_item_active")}),s},toggleFilter(e,s,r){hasClass(e,"search_filter_shut")||!isVisible(s)?(addClass(e,"search_filter_open"),removeClass(e,"search_filter_shut"),slideDown(s,200,()=>{checkPageBlocks(),r&&r()})):slideUp(s,200,()=>{addClass(e,"search_filter_shut"),removeClass(e,"search_filter_open"),r&&r()})},switchFilter(e,s,r){if(checkEvent(r))return!1;ge(`c[${e}]`)&&(ge(`c[${e}]`).value=s),"video"===cur.section&&"quality"===e&&ge("c[hd]")&&(ge("c[hd]").value=s<0?0:1),searcher.updResults()},appendElements(e){if(e){for(;e.firstChild;)e.parentNode.insertBefore(e.firstChild,e);re(e)}},showMore(){var e=ge("ui_search_load_more"),s=ge("search_more_results");if(e&&isVisible(e)&&!cur.isSearchLoading)if(s&&searcher.appendElements(s),cur.has_more){cur.disableAutoMore=!1,cur.isSearchLoading=!0,lockButton(e);var r=searcher.getSectionParams();r.offset=cur.offset,r.qid=cur.qid,r.edit=nav.objLoc.edit,r.sign=nav.objLoc.sign,r.all=nav.objLoc.all,ajax.post("al_search.php",r,{onDone(s,r){cur.isSearchLoading=!1,r&&(ge("no_results")&&re("no_results"),ge("results").insertBefore(ce("div",{innerHTML:r,id:"search_more_results"}),e)),unlockButton(e),searcher.applyOptions(s),searcher.scrollCheck()},cache:"audio"!==r["c[section]"]||r["c[q]"]?1:0})}else hide(e);else s&&searcher.appendElements(s)},close:()=>nav.go(cur.search_return_to,{},{back:!0}),toggleMinimizedFilters(e,s,r){var t=e&&domNS(e),c=r?0:200;return void 0===s&&(s=!isVisible(t)),!s&&isVisible(t)?(cur.filtersShown=!1,removeClass(e,"ui_rmenu_item_expanded"),slideUp(t,c)):s&&!isVisible(t)&&(cur.filtersShown=!0,val("c[category]",0),addClass(e,"ui_rmenu_item_expanded"),slideDown(t,c)),!1},onCommunitiesToggle(){"search"==cur.module&&(uiRightMenu.switchMenu(geByClass1(`search_menu_${cur.section}`,"search_menu")),searcher.updResults())},subscribe(e,s,r,t,c,i,a){var o,n,l=gpeByClass("search_row",e);if(cur.unsubscribed=cur.unsubscribed||{},!t&&i&&!cur.unsubscribed[s]){var u=showFastBox({title:getLang("global_warning"),dark:1,bodyStyle:"padding: 20px; line-height: 160%;"},getLang(i),getLang("search_group_leave"),()=>{u.hide(),searcher.subscribe(e,s,r,t,c)},getLang("global_cancel"));return!1}t?(o="al_feed.php",n={act:"subscr",oid:s,hash:r,from:c||"search",ref:cur.module}):(o="al_fans.php",n={act:"unsub",oid:s,hash:r,from:"search",ref:cur.module}),ajax.post(o,n,{onDone(){a?toggleClass(l,"touched",!!t):(toggle(`search_sub${s}`,!t),toggle(`search_unsub${s}`,!!t)),t||(cur.unsubscribed[s]=1)},onFail(e){if(e)return setTimeout(showFastBox(getLang("global_error"),e).hide,2e3),!0},showProgress(){a?(e.tt&&e.tt.destroy(),addClass(l,"loading")):lockButton(e)},hideProgress(){a?removeClass(l,"loading"):unlockButton(e)}})},onResize(){searcher.scrollCheck()},scrollCheck(){if(!(browser.mobile||cur.isSearchLoading||cur.disableAutoMore)){var e=ge("ui_search_load_more");if(isVisible(e)){var s=document.documentElement,r=window.innerHeight||s.clientHeight||bodyNode.clientHeight;scrollGetY()+r+200>e.offsetTop&&searcher.showMore()}else{var t=ge("search_more_results");t&&searcher.appendElements(t)}}},init(e){var s=globalHistory.length;s&&globalHistory[s-1]&&globalHistory[s-1].loc.indexOf("search")?cur.search_return_to=globalHistory[s-1].loc:cur.search_return_to="/",hide("header");var r=ge("search_query");if(!(r&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_4__.data)(r,"opts")||{}).isNew){var t=window.iSearch;t.destroy(),vk.id&&t.init(r)}elfocus(r),"search"===nav.objLoc[0]&&(extend(cur,{oid:e.user_id,module:"search"}),cur.nav.push((e,s,r)=>{if(void 0!==e[0]||cur.searchLoc&&void 0!==e.act)return clearTimeout(cur.setLocTO),void(nav.strLoc!==cur.loc&&cur.loc&&hab.setLoc(cur.loc));if(cur.searchLoc){var t=!1;for(var c in r)if("c["===c.substr(0,2)){t=!0;break}if(cur.onLocationChange&&cur.onLocationChange(t),!t)return!0}var i=clone(r);delete i[0];var a=i["c[section]"]||i.section||"quick";return ge("search_menu")&&uiRightMenu&&uiRightMenu.switchMenu(geByClass1(`search_menu_${a}`,"search_menu")),searcher.setSection(a),searcher.sendSearchReq(i,!0),!1})),cur.options||(cur.options={reply_names:{}}),extend(cur.options,e),searcher.applyOptions(e),r.ignoreFixed="statuses"==cur.section,window.scrollTop=bodyNode.scrollTop=pageNode.scrollTop=htmlNode.scrollTop=0,addEvent(window,"scroll",searcher.scrollCheck),addEvent(window,"resize",searcher.onResize),setTimeout(searcher.scrollCheck,50),setTimeout(checkPageBlocks,200);var c=window.audioPlayer;c&&c.showCurrentTrack&&c.showCurrentTrack(),cur._back={text:getLang("search_back_to"),show:[()=>{hide("header");var e=globalHistory.length;e&&globalHistory[e-1]&&globalHistory[e-1].loc.indexOf("search")&&(cur.search_return_to=globalHistory[e-1].loc),addEvent(window,"scroll",searcher.scrollCheck),addEvent(window,"resize",searcher.onResize);var s=window.iSearch;s.destroy(),vk.id&&s.init(ge("search_query"))}],hide:[()=>{removeEvent(window,"scroll",searcher.scrollCheck),removeEvent(window,"resize",searcher.onResize),window.iSearch.destroy()}]}}},iSearch={init(e,s){if(!this.inited){this.inited=!0,this.input=e,this.cont=e.parentNode.parentNode;var r=ce("div",{className:"results_container",innerHTML:'<div class="result_list"></div>'});this.cont.appendChild(r),this.resultList=geByClass("result_list",r)[0],hide(this.resultList),browser.chrome&&(this.resultList.style.opacity=1),this.resultList.style.width=r.style.width="552px",this.onShowCallback=!!s&&s.onShow,this.initSelect(s),addEvent(e,"keyup click mouseup",this.inputUpHandler),addEvent(document,"click",this.documentClick),addEvent(e,"keypress keydown",this.inputDownHandler),setTimeout(()=>{cur.params&&cur.params["c[q]"]&&Object(_web_lib_stats__WEBPACK_IMPORTED_MODULE_2__.saveSearchAttemptStats)("friends"===cur.module?"friends_find":`search_${cur.section}`,0,!isVisible(ge("no_results")),cur.params["c[q]"])},0),ge("top_search")&&(ge("top_search").onclick=e=>hab.getLoc().indexOf("search")?nav.go("search",e,{search:!0}):(window.searcher&&searcher.close(),!1))}},inputUpHandler(e){var s=window.iSearch;if(s.select){if((s.select.isVisible()&&s.select.active>-1||cur.preventISRequest)&&(delete cur.preventISRequest,inArray(e.keyCode,[KEY.UP,KEY.DOWN,KEY.PAGEUP,KEY.PAGEDOWN,KEY.RETURN])))return cancelEvent(e);clearTimeout(cur.requestTimeout);var r=val(s.input);s.currentTerm=r;var t=cur.section;r?cur.requestTimeout=setTimeout(()=>{cur.setISearch=!0,ajax.post("/hints.php?act=a_gsearch_hints",{q:r,section:t},{onDone(e){s.currentTerm===r&&cur.setISearch&&s.showSelectList(r,e),delete cur.setISearch},cache:1})},300):s.select.hide()}},documentClick(){var e=window.iSearch;e.select&&e.select.hide()},inputDownHandler(e){var s=window.iSearch;if(s.select){if(!s.select||s.select.active<0)return e.keyCode===KEY.RETURN&&s.select&&(cur.preventISRequest=!0,s.select.hide()),!0;if(e.keyCode===KEY.SPACE||(e.keyCode===KEY.RETURN||10===e.keyCode)&&s.select&&s.select.isVisible()){var r,t=s.select.list.childNodes[s.select.active],c=t?t.getAttribute("val"):"";if(each(s.lastItems,function(){this[0]===c&&(r=this)}),!r)return;return val(s.input,r[3]+(e.keyCode===KEY.SPACE?" ":"")),elfocus(s.input,s.input.length),e.keyCode!==KEY.SPACE&&(cur.preventISRequest=!0,s.select.hide(),searcher.updResults()),cancelEvent(e)}return e.keyCode!==KEY.RETURN&&10!==e.keyCode||!s.select||!s.select.isVisible()||(triggerEvent(document,e.type,e),cancelEvent(e))}},initSelect(){var e=window._iu,s=window.Select;if(!this.select&&s&&e&&this.resultList){this.guid=e.reg(this);var r=this;this.select=new s(this.resultList,{selectFirst:!1,onItemSelect:this.onItemSelect.bind(this),onShow:()=>(isFunction(r.onShowCallback)&&r.onShowCallback(),e.sel(r.guid)),onHide:e.sel.pbind(!1),cycle:!0}),this.select.hide()}},showSelectList(e,s){this.select&&((s=isArray(s)&&s.length?s:[]).length?(this.select.clear(),this.lastItems=s,this.select.content(s),this.select.show(),isFunction(this.onShowCallback)&&this.onShowCallback()):this.select.hide())},onItemSelect(e){var s;if(this.select&&(this.select.hide(),each(this.lastItems,function(){this[0]===e&&(s=this)}),s)){var r=ce("div",{innerHTML:s[3]});val(this.input,r.innerText||r.textContent),this.input.blur(),searcher.updResults()}},onEvent(e){e.type===(browser.opera||browser.mozilla?"keypress":"keydown")&&this.select.handleKeyEvent(e)},destroy(e){cleanElems(this.resultList),clearTimeout(e?e.requestTimeout:cur.requestTimeout),removeEvent(this.input,"keyup click mouseup",this.inputUpHandler),removeEvent(document,"click",this.documentClick),removeEvent(this.input,"keypress keydown",this.inputDownHandler),this.select&&(this.select.destroy(),delete this.select),this.resultList&&re(this.resultList.parentNode),delete this.lastItems,this.inited=!1},updateResultsList(e){e?e+="px":e=hasClass(ge("search_query_wrap"),"wide")?"512px":"451px",this.resultList.style.width=e}}}}]);try{stManager.done("cmodules/bundles/d14210db89a37ef97acca2f934f28b98.0a2f11a7b1d9616445d5.js")}catch(e){}