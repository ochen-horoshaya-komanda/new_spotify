!function(r){function s(s){for(var t,c,l=s[0],n=s[1],a=s[2],h=0,p=[];h<l.length;h++)c=l[h],o[c]&&p.push(o[c][0]),o[c]=0;for(t in n)Object.prototype.hasOwnProperty.call(n,t)&&(r[t]=n[t]);for(u&&u(s);p.length;)p.shift()();return i.push.apply(i,a||[]),e()}function e(){for(var r,s=0;s<i.length;s++){for(var e=i[s],t=!0,l=1;l<e.length;l++){var n=e[l];0!==o[n]&&(t=!1)}t&&(i.splice(s--,1),r=c(c.s=e[0]))}return r}var t={},o={"web/groups_list":0},i=[];function c(s){if(t[s])return t[s].exports;var e=t[s]={i:s,l:!1,exports:{}};return r[s].call(e.exports,e,e.exports,c),e.l=!0,e.exports}c.m=r,c.c=t,c.d=function(r,s,e){c.o(r,s)||Object.defineProperty(r,s,{enumerable:!0,get:e})},c.r=function(r){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(r,"__esModule",{value:!0})},c.t=function(r,s){if(1&s&&(r=c(r)),8&s)return r;if(4&s&&"object"==typeof r&&r&&r.__esModule)return r;var e=Object.create(null);if(c.r(e),Object.defineProperty(e,"default",{enumerable:!0,value:r}),2&s&&"string"!=typeof r)for(var t in r)c.d(e,t,function(s){return r[s]}.bind(null,t));return e},c.n=function(r){var s=r&&r.__esModule?function(){return r.default}:function(){return r};return c.d(s,"a",s),s},c.o=function(r,s){return Object.prototype.hasOwnProperty.call(r,s)},c.p="/js/cmodules/";var l=window.webpackJsonp=window.webpackJsonp||[],n=l.push.bind(l);l.push=s,l=l.slice();for(var a=0;a<l.length;a++)s(l[a]);var u=n;i.push([135,"bundles/common"]),e()}({135:function(r,s,e){r.exports=e("4HDr")},"4HDr":function(r,s,e){"use strict";e.r(s);e("Vd3H"),e("OG14"),e("Oyvg"),e("pIFo");var t=e("XzvV");window.GroupsList={rand:function(){return Math.floor(1e4*Math.random())},toggleFave:function(r,s,e,t){var o=parseInt(r.getAttribute("data-value"))?1:0;ajax.post("fave.php",{act:o?"a_delete_group":"a_add_group",gid:s,hash:e},{onDone:e=>{val(r,e),r.setAttribute("data-value",1-o),this.updateGroupField(s,12,1-o)},showProgress:lockActionsMenuItem.pbind(r),hideProgress:unlockActionsMenuItem.pbind(r)}),cancelEvent(t)},toggleSubscription:function(r,s,e,t){var o=parseInt(r.getAttribute("data-value"))?1:0;ajax.post("al_wall.php",{act:"a_toggle_posts_subscription",subscribe:o?0:1,oid:-s,hash:e},{onDone:e=>{val(r,e),r.setAttribute("data-value",1-o),this.updateGroupField(s,13,1-o)},showProgress:lockActionsMenuItem.pbind(r),hideProgress:unlockActionsMenuItem.pbind(r)}),cancelEvent(t)},subscribe:function(r,s,e,t){var o=hasClass(r,"flat_button");if(!(o&&buttonLocked(r)||actionsMenuItemLocked(r))){var i=o?hasClass(r,"secondary"):!cur.scrollList.deleted[s];!function t(c){ajax.post("al_groups.php",{act:i?"list_leave":"list_enter",gid:s,hash:e,confirm:c},{showProgress:(o?lockButton:lockActionsMenuItem).pbind(r),hideProgress:(o?unlockButton:unlockActionsMenuItem).pbind(r),onDone:function(e,c,l){if(c){var n=showFastBox(getLang("global_warning"),c,getLang("group_leave_group"),function(){n.hide(),t(1)},getLang("global_cancel"));return!0}if(val(r,e),cur.scrollList.deleted[s]=i,o)toggleClass(r,"secondary",!i);else{var a=domClosest("_gl_row",r);toggleClass(a,"deleted",i),l&&addClass(a,"closed")}},onFail:function(r){setTimeout(showFastBox(getLang("global_error"),r).hide,3e3)}})}()}},updateGroupField:function(r,s,e){cur.scrollList&&cur.scrollList.lists&&each(cur.scrollList.lists,function(){if(this&&this.length)for(var t=0,o=this.length;t<o;++t)if(this[t][2]==r){this[t][s]=e;break}})},enter:function(r,s,e,t,o){if(cur.invSwitching)return setTimeout(()=>this.enter(r,s,e,t,o),100),!1;var i,c,l=cur.scrollList.tab;"button"!=r.tagName.toLowerCase()?(r.backhtml||(r.backhtml=r.innerHTML),i=function(){var s=getSize(r)[0];r.innerHTML='<span class="progress_inline"></span>',setStyle(domFC(r),{width:s})},c=function(){r.innerHTML=r.backhtml}):(i=lockButton.pbind(r),c=unlockButton.pbind(r));var n=this.rand(),a=this.rand();cur.scrollList[n]=a,cur.invSwitching=!0,ajax.post("/al_groups.php",{act:"enter",gid:s,hash:e,context:"2"+(t?"_"+t:"")},{onDone:(r,e)=>{if(cur.invSwitching=!1,cur.scrollList&&cur.scrollList[n]==a){var i=cur.scrollList.lists[l],c=o?5:1;if("unsure"==t?c=o?5:3:"decline"==t?c=o?-3:-1:"undecided"==t&&(c=4),i&&"loading"!=i&&"update"!=i)for(var u=0,h=i.length;u<h;++u)i[u][2]==s&&(i[u][1]=c);else cur.scrollList.processed[l][s]=c;if(r&&cur.scrollList.lists.groups){var p=cur.scrollList.lists.groups;if("join"!=t&&"unsure"!=t&&t){if("undecided"==t)for(var d in p)p[d][2]==r[2]&&(p.splice(d,1),cur.scrollList.counts.groups--)}else p.unshift(r),cur.scrollList.counts.groups++;this.updateIndexer(p),this.showMore(!0)}TopNotifier&&!TopNotifier.shown()&&TopNotifier.invalidate();var g=ge("gl_inv"+s),f=g&&geByClass1("group_row_status",g);g&&(f.basehtml=f.innerHTML,f.innerHTML=e)}},onFail:function(r){if(r)return setTimeout(showFastBox(getLang("global_error"),r).hide,3e3),!0},showProgress:i,hideProgress:c})},leave:function(r,s,e,t){if(cur.invSwitching)return setTimeout(()=>this.leave(r,s,e,t),100),!1;if(!r.firstChild||"progress_inline"!=r.firstChild.className){var o,i,c=this.rand(),l=this.rand(),n=cur.scrollList.tab;cur.scrollList[c]=l,"button"!=r.tagName.toLowerCase()?(r.backhtml||(r.backhtml=r.innerHTML),o=function(){var s=getSize(r)[0];r.innerHTML='<span class="progress_inline"></span>',setStyle(domFC(r),{width:s})},i=function(){r.innerHTML=r.backhtml}):(o=lockButton.pbind(r),i=unlockButton.pbind(r)),cur.invSwitching=!0,ajax.post("/al_groups.php",{act:"leave",gid:s,hash:e,context:2},{onDone:function(r,e){if(cur.invSwitching=!1,cur.scrollList&&cur.scrollList[c]==l){var t=cur.scrollList.lists[n];if(t&&"loading"!=t&&"update"!=t)for(var o=0,i=t.length;o<i;++o)t[o][2]==s&&(t[o][1]=-1);else cur.scrollList.processed[n][s]=-1;TopNotifier&&!TopNotifier.shown()&&TopNotifier.invalidate();var a=ge("gl_inv"+s),u=a&&geByClass1("group_row_status",a);a&&(u.basehtml=u.innerHTML,u.innerHTML=e)}},showProgress:o,hideProgress:i})}},spam:function(r,s,e){if(!domFC(r)||"progress_inline"!=domFC(r)){var t=this.rand(),o=this.rand(),i=cur.scrollList.tab;cur.scrollList[t]=o,ajax.post("/al_groups.php",{act:"spam",gid:s,hash:e,context:1},{onDone:function(r){if(cur.scrollList&&cur.scrollList[t]==o){var e=cur.scrollList.lists[i];if(e&&"loading"!=e&&"update"!=e)for(var c=0,l=e.length;c<l;++c)e[c][2]==s&&(e[c][1]=-2);else cur.scrollList.processed[i][s]=-2;var n=ge("gl_inv"+s),a=n&&geByClass1("group_row_status",n);n&&(a.innerHTML=r)}},showProgress:function(){r.oldhtml=r.innerHTML;var s=getSize(r)[0];r.innerHTML='<span class="progress_inline"></span>',setStyle(domFC(r),{width:s})},hideProgress:function(){r.innerHTML=r.oldhtml}})}},cancel:function(r,s,e){if(!domFC(r)||"progress_inline"!=domFC(r).className){var t=this.rand(),o=this.rand(),i=cur.scrollList.tab;cur.scrollList[t]=o,ajax.post("/al_groups.php",{act:"cancel",gid:s,hash:e,context:1},{onDone:()=>{if(cur.scrollList&&cur.scrollList[t]==o){var r=cur.scrollList.lists[i];if(r&&"loading"!=r&&"update"!=r){for(var e in r)r[e][2]==s&&(r.splice(e,1),cur.scrollList.counts.groups--);this.updateIndexer(r),this.showMore(!0)}else cur.scrollList.processed[i][s]=0;var c=ge("gl_inv"+s),l=c&&geByClass1("group_row_status",c);c&&l&&l.basehtml&&(l.innerHTML=l.basehtml)}},showProgress:function(){r.oldhtml=r.innerHTML;var s=getSize(r)[0];r.innerHTML='<span class="progress_inline"></span>',setStyle(domFC(r),{width:s})},hideProgress:function(){r.innerHTML=r.oldhtml}})}},updateIndexer:function(r){cur.scrollList.cache.groups={all:[]};var s=cur.scrollList.cache.groups;for(var e in r)r.hasOwnProperty(e)&&s.all.push(e);cur.scrollList.index.groups=new vkIndexer(s.all,function(s){return r[s][0]})},rejectAll:function(r,s){showFastBox(getLang("global_warning"),getLang("groups_sure_reject_all"),getLang("groups_reject_all_inv"),function(r){ajax.post("/al_groups.php",{act:"reject_all",hash:s},{showProgress:lockButton.pbind(r),hideProgress:unlockButton.pbind(r)})},getLang("global_cancel"))},scrollCheck:function(){if(!browser.mobile&&cur.scrollList){var r=ge("ui_"+cur.scrollList.tab+"_load_more"),s=ge("ui_search_load_more");if(isVisible(r)||(r=s,isVisible(r))){var e=document.documentElement,t=window.innerHeight||e.clientHeight||bodyNode.clientHeight,o=scrollGetY();(o+t>r.offsetTop||cur.searchOffset&&o+2*t>r.offsetTop)&&this.showMore()}}},initScroll:function(){this.destroyScroll(),this._scrollCheck=()=>this.scrollCheck(),addEvent(window,"scroll",this._scrollCheck),addEvent(window,"resize",this._scrollCheck)},destroyScroll:function(){removeEvent(window,"scroll",this._scrollCheck),removeEvent(window,"resize",this._scrollCheck)},locNav:function(r,s,e){var t=r.tab,o=t||("events"==e.act?"future":"groups");if(delete r.tab,isEmpty(r)&&void 0!==t)return hide("groups_list_tab_"+cur.scrollList.tab),this.updateSummary(cur.scrollList.counts[cur.scrollList.tab]),cur.scrollList.tab=o,cur.scrollList.summary=geByClass1("ui_tab_count",ge("groups_"+o+"_tab")),show("groups_list_tab_"+o),checkPageBlocks(),nav.setLoc(e),window.uiSearch&&uiSearch.reset(cur.scrollList.query,!0),elfocus(cur.scrollList.query),this.updateSummary(cur.scrollList.counts[o]),cur.scrollList.offset=ge("groups_list_"+o).childNodes.length,this.showMore(!0),window.uiTabs&&uiTabs.hideProgress(ge("groups_"+o+"_tab")),!1},init:function(r){extend(cur,{module:"groups_list",_back:{text:getLang("groups_back_to_list"),show:[()=>this.initScroll,elfocus.pbind("groups_list_search")],hide:[()=>this.destroyScroll]},scrollList:{tab:r.tab,url:"al_groups.php",params:{act:"get_list",mid:r.mid},prefix:"groups_list_",query:ge("groups_list_search"),queryCont:gpeByClass("_wrap",ge("groups_list_search")),queryWrap:ge("group_u_search_input_wrap"),summary:geByClass1("ui_tab_count",ge("groups_"+(r.tab||"groups")+"_tab")),searchSummary:ge("groups_search_summary"),invites:ge("groups_invites_wrap"),invitesPreload:ge("groups_invites_preload"),invitesMoreLnk:ge("ui_invites_load_more"),searchWrap:ge("groups_list_search_wrap"),searchCont:ge("groups_list_search_cont"),eventsPopular:ge("events_popular_list"),perpage:20,offset:ge("groups_list_"+r.tab).childNodes.length,lists:{},cache:{},index:{},deleted:{},processed:{groups:{},admin:{},inv:{},future:{},past:{},events_concerts:{}},filtered:{},queries:{},counts:r.counts,genEmpty:r.genEmpty,genRow:r.genRow,genSummary:r.genSummary,genGroupsSummary:r.genGroupsSummary,invShown:r.invShown},filter:r.filter}),setTimeout(elfocus.pbind(cur.scrollList.query),0),Object(t.saveSearchAttemptStats)("groups",0,cur.scrollList.offset,""),cur.nav.push(()=>this.locNav),setTimeout(()=>this.load,0),vk.version?addEvent(window,"load",()=>this.initScroll):this.initScroll(),cur.destroy.push(r=>{r==cur&&this.destroyScroll()})},updateSummary:function(r,s){val(s?cur.scrollList.searchSummary:cur.scrollList.summary,r?langNumeric(r,"%s",!0):"")},load:function(r,s){var e=s||cur.scrollList.tab;if(!cur.scrollList.lists[e]){var t=this.rand(),o=this.rand();cur.scrollList[t]=o,cur.scrollList.lists[e]="loading",ajax.post(cur.scrollList.url,extend(cur.scrollList.params,{tab:e}),{onDone:s=>{if(cur.scrollList&&cur.scrollList[t]==o){var i="update"==cur.scrollList.lists[e];if(i||"loading"==cur.scrollList.lists[e]){cur.scrollList.cache[e]={all:[]};for(var c=cur.scrollList.processed[e],l=0,n=s.length;l<n;++l){var a=c[s[l][2]];a&&(s[l][1]=a),cur.scrollList.cache[e].all.push(l)}cur.scrollList.indexing||(cur.scrollList.indexing={}),cur.scrollList.indexing[e]=!0,cur.scrollList.lists[e]=s;var u=i?()=>{cur.scrollList&&cur.scrollList[t]==o&&cur.scrollList.tab==e&&this.showMore(r)}:function(){};cur.scrollList.index[e]=new vkIndexer(cur.scrollList.cache[e].all,function(r){return delete cur.scrollList.indexing[e],cur.scrollList.lists[e][r][0]},u)}}},local:1})}},getHighlight:function(r){var s=cur.scrollList.index[cur.scrollList.tab],e=s.delimiter,t=s.trimmer;return r+=" "+(parseLatin(r)||""),r=(r=escapeRE(r).replace(/&/g,"&amp;")).replace(t,"").replace(e,"|").replace(/(^\||\|$)/g,""),{re:new RegExp("("+r+")","gi"),val:'<span class="highlight">$1</span>'}},onSearchChange:function(r,s){delete cur.exactSearch,this.showMore(!1)},onSearchEnter:function(r,s){cur.exactSearch=1,this.showMore(!0)},showMore:function(r){var s=cur.scrollList.tab,e=cur.scrollList.lists[s];if(!e||"loading"==e||"update"==e)return e||this.load(r),void(cur.scrollList.lists[s]="update");if(!cur.scrollList.indexing||!cur.scrollList.indexing[s]){s=cur.scrollList.tab,e=cur.scrollList.cache[s].all;var o=trim(cur.scrollList.query.value);cur.searchStr=o,void 0===cur.scrollList.queries[s]&&(cur.scrollList.queries[s]="");var i=r||o!=cur.scrollList.queries[s];if(i||!1!==r){cur.scrollList.queries[s]=o;var c=!1;if(o){if(void 0===(e=cur.scrollList.cache[s]["_"+o])){var l=cur.scrollList.index[s].search(o),n={};e=[];for(var a=0,u=l.length;a<u;++a)n[l[a]]||(n[l[a]]=!0,e.push(l[a]));e.sort(function(r,s){return r-s}),cur.scrollList.cache[s]["_"+o]=e}c=this.getHighlight(o)}var h=e.length,p=ge(cur.scrollList.prefix+s),d=ge("ui_"+s+"_load_more");if(this.updateSummary(h),h&&i&&Object(t.saveSearchAttemptStats)("groups",0,h,o),!h)return p.innerHTML=cur.scrollList.genEmpty(o),void(o&&this.needSearch(s)?i?(this.serverSearch(p,o),hide(d)):cur.searchOffset&&this.serverSearchMore(p,o):(hide(d),hide(cur.scrollList.searchWrap),show(cur.scrollList.eventsPopular),cur.searchOffset=0));for(var g=i?0:cur.scrollList.offset,f=Math.min(h,g+cur.scrollList.perpage),L=[],v=g;v<f;++v){var _=cur.scrollList.lists[s][e[v]];if(_){var m=_[0];c&&(m=m.replace(c.re,c.val)),L.push(cur.scrollList.genRow(_,m))}}if(o||g&&!i||(hide(cur.scrollList.searchWrap),show(cur.scrollList.eventsPopular),cur.searchOffset=0),i)if(hasClass(cur.scrollList.queryCont,"ui_search_fixed")&&scrollToY(getXY(cur.scrollList.queryWrap)[1]+1,0),p.innerHTML=L.join(""),checkPageBlocks(),cur.searchOffset=!1,e.length<5&&o&&this.needSearch(s)){var w,b=[];for(var S in e)e.hasOwnProperty(S)&&(w=cur.scrollList.lists[s][e[S]],b.push(w[2]));this.serverSearch(p,o,b)}else hide(cur.scrollList.searchWrap),show(cur.scrollList.eventsPopular),cur.searchOffset=0;else p.innerHTML+=L.join(""),cur.searchOffset&&this.serverSearchMore(p,o);cur.scrollList.offset=f,cur.searchOffset||(f<h?show:hide)(d)}}},showMoreInvites:function(r){if(!cur.loadingInvites){for(var s=cur.scrollList.invites&&geByClass1("groups_list",cur.scrollList.invites),e=cur.scrollList.invitesPreload,t=cur.scrollList.invitesMoreLnk;domFC(e);)s.appendChild(domFC(e)),cur.scrollList.invShown++;toggle(t,cur.scrollList.counts.invite>cur.scrollList.invShown),isVisible(t)&&ajax.post("/al_groups.php",{act:"more_invites",offset:cur.scrollList.invShown},{onDone:function(r,s){e.innerHTML=r,s&&(cur.scrollList.counts.invite-=s)},showProgress:function(){cur.loadingInvites=!0},hideProgress:function(){cur.loadingInvites=!1}})}},serverSearchMore:function(r,s){if(!cur.searchLoadingMore){cur.searchLoadingMore=1;var e=ge("ui_search_load_more");ajax.post("/al_groups.php",{act:"server_search",q:s,offset:cur.searchOffset,exact:cur.exactSearch,exclude:cur.searchExclude.join(",")},{onDone:function(r,s,e){cur.searchLoadingMore=0,r?(cur.searchOffset=e,cur.scrollList.searchCont.appendChild(cf(s))):cur.searchOffset=0,(!s||e>=r?hide:show)("ui_search_load_more")},onFail:function(){cur.searchLoadingMore=0},showProgress:lockButton.pbind(e),hideProgress:unlockButton.pbind(e)})}},extendedSearch:function(r){clearTimeout(cur.searchTimeout),cur.searchTimeout=setTimeout(function(){var s=geByClass1("groups_section_search");window.searcher&&s?hasClass(s,"ui_rmenu_item_sel")?window.searcher.onEnter():(uiRightMenu.switchMenu(s),uiRightMenu.showProgress(s),nav.go(s.href+"&c[like_hints]=1&c[q]="+r)):nav.go("/groups?act=catalog&c[q]="+r)},500)},onExtendedSearchChange:function(r,s){val("c[like_hints]",1),this.extendedSearch(r)},onExtendedSearchEnter:function(r,s,e){val("c[like_hints]",""),this.extendedSearch(s)},needSearch:function(r){return"groups"==r||"future"==r||"past"==r},serverSearch:function(r,s,e){if(!this.needSearch(cur.scrollList.tab))return!1;clearTimeout(cur.searchTimeout),cur.searchTimeout=setTimeout(()=>{if(cur.searchStr==s){cur.searchExclude=e||[];var r=+new Date;ajax.post("/al_groups.php",{act:"server_search",q:s,exact:cur.exactSearch,exclude:cur.searchExclude.join(",")},{onDone:(e,o,i,c)=>{cur.searchStr==s&&(!s||cur.searchExclude&&cur.searchExclude.length||Object(t.saveSearchAttemptStats)("groups",r,e,s,0,c),e?(cur.scrollList.searchCont.innerHTML=o,show(cur.scrollList.searchWrap),hide(cur.scrollList.eventsPopular),(i<e||!o)&&show("ui_search_load_more")):(cur.scrollList.searchCont.innerHTML="",hide(cur.scrollList.searchWrap),show(cur.scrollList.eventsPopular)),checkPageBlocks(),this.updateSummary(e,!0),cur.searchOffset=i)},showProgress:uiSearch.showProgress.pbind(cur.scrollList.query),hideProgress:uiSearch.hideProgress.pbind(cur.scrollList.query)})}},300)},showMapBox:function(r,s,e){window.showZeroZoneBox&&window.showZeroZoneBox("places",()=>{this.showMapBox(r,s,e)})||showTabbedBox("/al_places.php",{act:"show_photo_place",place_id:r},{stat:["places.css","map.css","maps.js","ui_controls.css","ui_controls.js"]})},feedbanGroup:function(r,s,e){var t=-s;ajax.post("/al_fans.php",{act:"feedtgl",oid:t,hash:e},{onDone:(e,t)=>{r.innerHTML=t,this.updateGroupField(s,9,e)},showProgress:function(){r.innerHTML='<span class="progress_inline"></span>'}})}};try{stManager.done(jsc("web/groups_list.js"))}catch(r){}}});