!function(e){function t(t){for(var o,s,a=t[0],d=t[1],h=t[2],c=0,u=[];c<a.length;c++)s=a[c],r[s]&&u.push(r[s][0]),r[s]=0;for(o in d)Object.prototype.hasOwnProperty.call(d,o)&&(e[o]=d[o]);for(l&&l(t);u.length;)u.shift()();return n.push.apply(n,h||[]),i()}function i(){for(var e,t=0;t<n.length;t++){for(var i=n[t],o=!0,a=1;a<i.length;a++){var d=i[a];0!==r[d]&&(o=!1)}o&&(n.splice(t--,1),e=s(s.s=i[0]))}return e}var o={},r={"web/groups_admins":0},n=[];function s(t){if(o[t])return o[t].exports;var i=o[t]={i:t,l:!1,exports:{}};return e[t].call(i.exports,i,i.exports,s),i.l=!0,i.exports}s.m=e,s.c=o,s.d=function(e,t,i){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(s.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)s.d(i,o,function(t){return e[t]}.bind(null,o));return i},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="/js/cmodules/";var a=window.webpackJsonp=window.webpackJsonp||[],d=a.push.bind(a);a.push=t,a=a.slice();for(var h=0;h<a.length;h++)t(a[h]);var l=d;n.push([128,"bundles/common","bundles/4977ab57d813269ae3b1ad54250b95c9","bundles/e239f4f3bb195925b3389c6e53d22608"]),i()}({"0CRY":function(e,t,i){"use strict";i.r(t);var o=i("EasH"),r=i("Egk5"),n=(i("pIFo"),i("a1Th"),i("Btvt"),i("SRfc"),i("v+DW")),s=845,a=655,d={onEditStart:"edit_start",onCropSuccess:"crop_success",onUploadStart:"upload_start",onDragOut:"drag_out",onDragEnter:"drag_enter",onUploadError:"upload_error"},h="owner_photo_img",l=26214400,c="owner_photo_done_edit",u=3.975;class p{constructor(e,t,i,o,r){this.emitter=r,this.groupId=e,this.thumbId=i,this.uploadOptions=this._getCoverUploadOptions(o,t),this.uploadEl=t,this.editOptions={},this.newEditOptions={},this.curEditOptions={},o.crop_options&&(this.editOptions=o.crop_options),this.mainCoverUpload=Upload.init(t,o.url,{},this.uploadOptions),this.coverCropDoneBtn=ge(c)}onUploadComplete(e,t,i){var o=window.parseJSON(t)||{};if(o.error)return this.showError(o.error),!1;var r=this._getCoverCropUrl(t),n=o.x_src;o.x_src.startsWith("http")||(n=this.uploadOptions.static_url+n);var s={thumb:n,thumbSize:o.x_size,size:o.size,uploadUrl:r};this.edit(!0,!0,s)}edit(e,t,i){if(!this.ownerPhotoThumb||t){var o=this.editOptions;isUndefined(i)||(o=i),this.curEditOptions=o,this.setCropWrap(o),this.ownerPhotoThumb=ge(h),window.stManager.add(["tagger.css","tagger.js"],this.initTagger.bind(this,o,e))}this.emitter.emit(d.onEditStart)}setCropWrap(e){var t=this.thumbId;toggleClass(t,"no_rotate");var i=this._getCropImageDiv(e);val(t,i)}initTagger(e,t){var i=this._getThumbOpts(e,t);this.ownerPhotoEditTagger&&this.ownerPhotoEditTagger.destroy(),this.ownerPhotoEditTagger=window.photoTagger(this.ownerPhotoThumb,i)}onCropSuccess(e,t,i){this.emitter.emit(d.onCropSuccess,i)}cropDone(){var e=this.ownerPhotoEditTagger.result(),t=this.curEditOptions,i=t.size[0]/t.thumbSize[0],o=t.size[1]/t.thumbSize[1],r=[Math.floor(e[0]*i),Math.floor(e[1]*o),Math.ceil(e[2]*i),Math.ceil(e[3]*o)],s=this.cropSuccess.bind(this,!0),a=t.uploadUrl+"&_full="+encodeURIComponent(r.join(","))+"&_rot=0";Object(n.lockButton)(this.coverCropDoneBtn),clearTimeout(this.ownerPhotoCropTimer),this.ownerPhotoCropTimer=setTimeout(this.cropSuccess.bind(this,!0,'{"error":"ERR_CLIENT_UPLOAD_TIMEOUT: no response on owner_photo_crop iframe request"}'),1e4),this.editOptions=t,window.stManager.add(["upload.js"],()=>{var e=[0,0,r[2]],t=window.jsonpManager.reg(s);window.utilsNode.appendChild(ce("iframe",{src:a+"&_crop="+e.join(",")+"&_jsonp="+t+"&_origin="+encodeURIComponent(locProtocol+"//"+locHost)}))})}cropSuccess(e,t){if(!0!==e&&(t=e,e=!1),clearTimeout(this.ownerPhotoCropTimer),(window.parseJSON(t)||{}).error)return Object(n.unlockButton)(this.coverCropDoneBtn),console.log("done_edit error"),!1;var i={showProgress:n.lockButton.pbind(this.coverCropDoneBtn),hideProgress:n.unlockButton.pbind(this.coverCropDoneBtn),onDone:this.onCropSuccess.bind(this),onFail:this.onCropFail.bind(this)};ajax.post("al_page.php",{act:"owner_photo_save",_query:t,from:"groups_edit",gid:this.groupId},i)}onCropFail(e){return this.showError(e),!0}_getCropImageDiv(e){var t=e.thumbSize,i=t?"width: "+t[0]+"px; height: "+t[1]+"px;":"";return`<div id="owner_photo_rotate">\n        <div style="${i}margin: 0px auto;">\n          <img class="owner_photo_img" id="owner_photo_img" src="${e.thumb}" style="${i}"/>\n        </div>\n    </div>`}_getCoverUploadOptions(e,t){return{file_name:"photo",file_size_limit:l,file_types_description:"Image files (*.jpg, *.jpeg, *.png, *.gif)",file_types:"*.jpg;*.JPG;*.jpeg;*.JPEG;*.png;*.PNG;",clear:1,type:"photo",noFlash:1,max_attempts:3,signed:1,static_url:e.static_url,check_url:e.check_url,base_url:e.base_url,lang:e.lang,dropbox:ge("groups_edit_cover_wrap_main_wrap_drop"),onUploadStart:this.onUploadStart.bind(this),onUploadComplete:this.onUploadComplete.bind(this),onDragEnter:this.onDragEnter.bind(this),onDragOut:this.onDragOut.bind(this)}}onUploadStart(){this.emitter.emit(d.onUploadStart)}onDragEnter(){this.emitter.emit(d.onDragEnter)}onDragOut(){this.emitter.emit(d.onDragOut)}_getCoverCropUrl(e){return this.uploadOptions.base_url+"upload.php?act=owner_cover_crop&_query="+encodeURIComponent(e)+"&_origin="+encodeURIComponent(window.locProtocol+"//"+window.locHost)}_getThumbOpts(e,t){var i=e.size,o=e.thumbSize,r=[Math.max(200,Math.ceil(795*o[0]/i[0])),Math.max(50,Math.ceil(200*o[1]/i[1]))];if(o[0]<r[0]||o[1]<r[1])return console.log("error"),!1;var n=1.5;return n=t?this._getRect(e):this._getRectStrict(e),{minw:r[0],minh:r[1],mina:u,maxa:u,rect:n,zstart:1e3}}_getRectStrict(e){var t=e.size,i=e.thumbSize;return{left:Math.floor(e.rect[0]*i[0]/t[0]),top:Math.floor(e.rect[1]*i[1]/t[1]),width:Math.ceil(e.rect[2]*i[0]/t[0]),height:Math.ceil(e.rect[3]*i[1]/t[1])}}_getRect(e){var t=e.thumbSize,i=u,o=1.5;return t[1]>=t[0]/i?(o={width:t[0]}).height=Math.ceil(o.width/i):(o={height:t[1]}).width=Math.ceil(o.height*i),o.height>1.5*o.width&&(o.height=Math.floor(1.5*o.width)),o.left=Math.floor((t[0]-o.width)/2),o.top=Math.floor((t[1]-o.height)/2),o}showError(e){e.match(/^ERR_[A-Z0-9_]+(\:|$)/)||(e='ERR_CLIENT_BAD_ERROR: error "'+clean(e.toString())+'"');var t=e.match(/^(ERR_[A-Z0-9_]+)(\:\s*|$)([\S\s]*)\s*$/),i=t[1],r="";switch(i){case"ERR_UPLOAD_FILE_NOT_SUPPORTED":r=getLang("profile_oph_err_format");break;case"ERR_UPLOAD_FILE_NOT_UPLOADED":r=getLang("profile_oph_err_upload").replace("{link}",'<a href="/support?act=new&from=ph">').replace("{/link}","</a>");break;case"ERR_UPLOAD_BAD_IMAGE_SIZE":r=getLang("groups_cover_photo_error_size").replace("{width}","795").replace("{height}","200");break;case"ERR_UPLOAD_BIG_IMAGE_SIZE":r=getLang("groups_cover_big_error_size").replace("{size}","14000");break;case"ERR_STORAGE_ENGINE_NOT_CONNECTED":case"ERR_STORAGE_ENGINE_SAVE_FAILED":r=getLang("profile_oph_error_server");break;default:r=getLang("profile_oph_err_unknown").replace("{link}",'<a href="/support?act=new&from=ph">').replace("{/link}","</a>")}return r=r.replace("{sorry}","<b>"+getLang("global_sorry_error")+"</b>")+'<br><a onclick="OwnerPhoto.detailsError(this);">'+getLang("global_error_details")+'</a><div class="unshown">Error: '+i+(t[3]?". Details: "+t[3]:".")+"</div>",this.emitter.emit(d.onUploadError),Object(o.showFastBox)(getLang("global_error"),r)}}var v=i("Klmf"),_=i("t7n3"),g=i("o9iI"),b={strokeDashArrayDef:5,strokeDashArrayTotal:200};class m{constructor(e,t,i,o,r){this.groupId=e,this.hash=t,this.file=i,this.emitter=o,this.state=v.UploadStoryState.waiting,this.story={},this.uploadProgressVal=b.strokeDashArrayDef,this.liveCover=r}start(e){this.state=v.UploadStoryState.uploading;var t={act:"stories_get_upload_url",id:this.groupId,type:this._isPhoto()?"photo":"video",hash:this.hash,live_cover:this.liveCover};Object(_.isUndefined)(e)||(t.position=e),ajax.post("groupsedit.php",t,{onDone:e=>{this.uploadUrl=e,this.state===v.UploadStoryState.uploading&&this.upload()},onFail:()=>(this._storyUploadDidFailed({unknown:!0}),!0)})}upload(){this.xhr=new XMLHttpRequest,this.xhr.upload.onprogress=this._uploadDidProgress.bind(this),this.xhr.onload=this.xhr.onerror=this._uploadDidFinish.bind(this),this.xhr.open("POST",this.uploadUrl,!0);var e=new FormData;e.append(this._isPhoto()?"file":"video_file",this.file),this.xhr.send(e)}destroy(){try{this.xhr&&this.xhr.abort(),this.xhr=!1}catch(e){}this.emitter.emit(v.UploaderEvents.didDestroyed,this)}_uploadDidProgress(e){var t=e.loaded/e.total;this.uploadProgressVal=(b.strokeDashArrayTotal-b.strokeDashArrayDef)*t+b.strokeDashArrayDef,this.emitter.emit(v.UploaderEvents.didProgress,this)}_uploadDidFinish(){if(200===this.xhr.status){var e=JSON.parse(this.xhr.responseText);e.response?(this.state=v.UploadStoryState.finished,this._storyUploadDidFinish(e.response.story)):this._storyUploadDidFailed(e.error)}else this._storyUploadDidFailed({unknown:!0});this.xhr=!1}_storyUploadDidFinish(e){this.storyRaw=`${e.owner_id}_${e.id}`;var t="video"===e.type?e.video.first_frame_320:Object(g.getPhotoUrl)(e.photo,"x");this.story={preview:t,isVideo:"video"===e.type,videoDuration:"video"===e.type?formatTime(e.video.duration):""},this.emitter.emit(v.UploaderEvents.didUploaded,this)}_storyUploadDidFailed(e){e.unknown||"flood"===e.type?this.state=v.UploadStoryState.failed:(this.emitter.emit(v.UploaderEvents.pushUploadError,this,e),this.emitter.emit(v.UploaderEvents.didRemove,this)),this.emitter.emit(v.UploaderEvents.didFailed,this)}_isPhoto(){return"image"===this.file.type.substr(0,5)}}var f=5,w=31457280,O={onDidUploaded:"onUpload",onProgress:"onProgress",onStart:"onStart",onError:"onError"};class E{constructor(e,t,i,o,r){this.groupId=e,this.wrapEl=t,this.uploadHash=i,this.emitter=o,this.filesCount=r}setCurFilesCount(e){this.filesCount=e}onDidUploaded(e){this.emitter.emit(O.onDidUploaded,e)}onDidProgress(e){this.emitter.emit(O.onProgress,e)}onDidFailed(e){this.emitter.emit(O.onError,getLang("groups_live_covers_error_upload_file_error"))}pushFiles(e,t){var i=!1;if(t>0&&(i=!0),e.length+this.filesCount>f&&!i)return this.emitter.emit(O.onError,getLang("groups_live_covers_error_upload_max_count_files")),!1;for(var o=0;o<e.length;o++){var r=e[o];if(r.size>w)this.emitter.emit(O.onError,getLang("groups_live_covers_error_upload_max_size"),!0);else{var n=new EventEmitter;n.on(v.UploaderEvents.didUploaded,this.onDidUploaded.bind(this)),n.on(v.UploaderEvents.didProgress,this.onDidProgress.bind(this)),n.on(v.UploaderEvents.didFailed,this.onDidFailed.bind(this));var s=new m(this.groupId,this.uploadHash,r,n,1);this.emitter.emit(O.onStart,o),s.start(t)}}}}var y=i("zxIV");i.d(t,"default",function(){return U});var C="#groups_edit_cover_header",j="#groups_edit_cover_wrap",I="#groups_edit_cover_wrap_main_input",T="#groups_edit_cover_wrap_live_upload_input",D="#groups_edit_cover_wrap_main_wrap",k="#groups_edit_cover_wrap_main_edit",S="#groups_edit_cover_wrap_main_edit_img",x="#owner_photo_edit",L="#groups_edit_cover_wrap_main_wrap_btn",B="#groups_edit_cover_wrap_live",R="loading";class U{constructor(e){this.groupId=e,this.reUploadCoverId=0,this.liveCoverPosition=-1,this.box={}}showBox(){var e={id:this.groupId,act:"edit_box"},t={containerClass:"groups_cover_box",params:{hideButtons:!0,width:655},onDone:this.onShowBoxDone.bind(this)};Object(o.showBox)("groupsedit_cover.php",e,t)}onShowBoxDone(e,t){this.box=e,this.headerEl=Object(y.domQuery1)(C,this.box.bodyNode),this.contentEl=Object(y.domQuery1)(j,this.box.bodyNode),this.mainCoverEl=Object(y.domQuery1)(D,this.box.bodyNode),this.mainCoverEditEl=Object(y.domQuery1)(k,this.box.bodyNode),this.mainCoverImgEl=Object(y.domQuery1)(S,this.box.bodyNode),this.mainCoverCropEl=Object(y.domQuery1)(x,this.box.bodyNode),this.mainCoverUploadEl=Object(y.domQuery1)(I,this.box.bodyNode),this.mainCoverUploadPlaceholder=Object(y.domQuery1)(L,this.mainCoverEl),this.liveWrapEl=Object(y.domQuery1)(B,this.box.bodyNode),this.initEvents(t)}onMainCoverUploadStart(){hide(this.mainCoverEditEl),show(this.mainCoverEl),Object(y.addClass)(this.mainCoverEl,R)}onMainCoverDragEnter(){hide(this.mainCoverUploadPlaceholder)}onMainCoverDragOut(){show(this.mainCoverUploadPlaceholder)}onMainCoverUploadError(){Object(y.removeClass)(this.mainCoverEl,R),attr(this.mainCoverImgEl,"src")&&(show(this.mainCoverEditEl),hide(this.mainCoverEl))}initEvents(e){var t=Object(y.domQuery1)(".groups_edit_cover_close",this.box.bodyNode);t&&Object(r.addEvent)(t,"click",()=>{this.box.hide()});var i=this.getMainCoverEmitter();this.uploadMain=new p(this.groupId,this.mainCoverUploadEl,Object(y.domQuery1)("#owner_photo_thumb",this.mainCoverCropEl),e.upload,i),[Object(y.domQuery1)(".groups_edit_cover_wrap_main_a",this.box.bodyNode),Object(y.domQuery1)(".upload",this.mainCoverEditEl)].forEach(e=>{Object(r.addEvent)(e,"click",e=>{Object(y.geByTag1)("button",this.mainCoverUploadEl).click()})});var o=Object(y.domQuery1)(".delete",this.mainCoverEditEl);o&&Object(r.addEvent)(o,"click",()=>{var e=Object(y.domData)(o,"hash");Page.deleteOwnerCover(-this.groupId,e,this.onMainCoverDelete.bind(this))});var s=Object(y.domQuery1)(".edit",this.mainCoverEditEl);s&&Object(r.addEvent)(s,"click",()=>{this.uploadMain.edit(!1)});var a=Object(y.domQuery1)("#groups_edit_cover_wrap_live_upload_input",this.contentEl);if(a&&Object(r.addEvent)(a,"change",()=>{this.onFileChange(a)}),this.liveWrapEl){this.liveWrapToDrag=Object(y.domQuery1)("#live_covers_to_drag",this.box.bodyNode);var d=new EventEmitter;d.on(O.onError,this.onUploadErrorLiveCover.bind(this)),d.on(O.onDidUploaded,this.onDidUploadedLiveCover.bind(this)),d.on(O.onStart,this.onUploadStartLiveCover.bind(this));var h=this.getLiveCoversCount();this.uploadLive=new E(this.groupId,this.liveWrapEl,e.uploadStoryHash,d,h),this.liveInputEl=Object(y.domQuery1)(T,this.box.bodyNode),Object(r.addEvent)(this.liveWrapEl,"dragenter dragover",this.dragDidEnter.bind(this)),Object(r.addEvent)(this.liveWrapEl,"dragleave",this.dragDidLeave.bind(this)),Object(r.addEvent)(this.liveWrapEl,"drop",this.dragDidDrop.bind(this)),this.reorderHash=e.reorderHash,this.deleteHash=e.deleteHash,this.initSorter(),this.initLiveCoverEvents()}var l=Object(y.domQuery1)("#groups_edit_cover_scalable",this.contentEl);l&&Object(r.addEvent)(l,"click",e=>{var t=Object(y.domData)(l,"hash");this.setScalable(l,t)});var c=Object(y.domQuery1)("#owner_photo_done_edit",this.mainCoverCropEl);c&&Object(r.addEvent)(c,"click",e=>{Object(n.lockButton)(c),this.editDone(),Object(n.unlockButton)(c)});var u=Object(y.domQuery1)("#owner_photo_upload_return",this.mainCoverCropEl);u&&Object(r.addEvent)(u,"click",e=>{this.uploadReturn()})}getMainCoverEmitter(){var e=new EventEmitter;return e.on(d.onEditStart,this.onMainCoverEdit.bind(this)),e.on(d.onCropSuccess,this.onMainCoverSave.bind(this)),e.on(d.onUploadStart,this.onMainCoverUploadStart.bind(this)),e.on(d.onDragEnter,this.onMainCoverDragEnter.bind(this)),e.on(d.onDragOut,this.onMainCoverDragOut.bind(this)),e.on(d.onUploadError,this.onMainCoverUploadError.bind(this)),e}initLiveCoverEvents(){Object(y.domQuery)("#live_covers_for_drag .groups_edit_cover_wrap_live_upload_placeholder_enabled",this.box.bodyNode).forEach(e=>{Object(r.removeEvent)(e,"click"),Object(r.addEvent)(e,"click",t=>{var i=Object(y.domData)(e,"pos");this.liveCoverUpload(t,i)})}),Object(y.domQuery)("#live_covers_to_drag .groups_edit_cover_wrap_live_upload",this.box.bodyNode).forEach(e=>{var t=Object(y.domQuery1)(".delete",e);Object(r.removeEvent)(t,"click"),Object(r.addEvent)(t,"click",e=>{this.liveCoverDelete(e)});var i=Object(y.domQuery1)(".upload",e);Object(r.removeEvent)(i,"click"),Object(r.addEvent)(i,"click",e=>{this.liveCoverChange(e)})})}onMainCoverEdit(){hide(this.contentEl),hide(this.headerEl),show(this.mainCoverCropEl),Object(y.removeClass)(this.mainCoverEl,R),this.box.setOptions({width:s})}onMainCoverSave(e,t){attr(this.mainCoverImgEl,"src",e),hide(this.mainCoverCropEl),hide(this.mainCoverEl),this.box.setOptions({width:a}),show(this.contentEl),show(this.headerEl),show(this.mainCoverEditEl),this.box.updateBoxCoords()}onMainCoverDelete(){window.curBox().hide(),hide(this.mainCoverEditEl),show(this.mainCoverEl),attr(this.mainCoverImgEl,"src","")}onFileChange(e){this.uploadLive.pushFiles(e.files,this.liveCoverPosition),this.liveCoverPosition=-1}liveCoverUpload(e,t){this.liveInputEl.click()}liveCoverDelete(e){Object(r.cancelEvent)(e);var t=e.target,i=Object(y.domData)(t,"cover-id");this.deleteLiveCover(i,t)}deleteLiveCover(e,t){if(this.deleteLock||(this.deleteLock=[]),this.deleteLock[e])return!1;var i={};return t&&(i={onDone:this.onLiveCoverDelete.bind(this,t),showProgress:()=>this.deleteLock[e]=!0,hideProgress:()=>this.deleteLock[e]=!1}),ajax.post("groupsedit_cover.php",{act:"a_delete_live",id:this.groupId,cover_id:e,hash:this.deleteHash},i),!1}liveCoverChange(e){Object(r.cancelEvent)(e);var t=e.target,i=Object(y.domData)(t,"cover-id");this.reUploadCoverId=i;var o=this.getCoverPosition(i);this.liveCoverPosition=o,this.liveInputEl.click()}onLiveCoverDelete(e){var t=domPN(domPN(domPN(e))),i=Object(y.geByTag1)("img",t);Object(y.removeClass)(t,"edit"),this.getLiveCoversCount()<4?Object(y.addClass)(t,"disabled"):Object(y.removeClass)(t,"disabled"),attr(i,"src","");var o=t.cloneNode(!0);re(t),Object(y.domQuery1)("#live_covers_for_drag",this.box.bodyNode).appendChild(o),this.uploadLive.setCurFilesCount(this.getLiveCoversCount()),this.initSorter(),this.initLiveCoverEvents()}editDone(){this.uploadMain.cropDone()}uploadReturn(){hide(this.mainCoverCropEl),hide(this.mainCoverEl),this.box.setOptions({width:a}),show(this.contentEl),show(this.headerEl),hide(this.mainCoverEditEl),""==attr(this.mainCoverImgEl,"src")?(show(this.mainCoverEl),hide(this.mainCoverEditEl),show(this.mainCoverUploadPlaceholder)):(hide(this.mainCoverEl),show(this.mainCoverEditEl)),this.box.updateBoxCoords()}initSorter(){if(this.getLiveCoversCount()<=1)return!1;var e={canDrag:!0,clsUp:"groups_edit_cover_wrap_live_upload_preview_drag",onReorder:this.onReorder.bind(this)};window.usorter.init("live_covers_to_drag",e)}onReorder(){if(!this.saveReorderLock){var e=Object(y.domQuery1)("#live_covers_to_drag",this.box.bodyNode),t=Object(y.geByClass)("groups_edit_cover_wrap_live_upload",e).map(e=>Object(y.domData)(e,"cover-id"));ajax.post("groupsedit_cover.php",{act:"a_reorder_live",id:this.groupId,hash:this.reorderHash,covers:t},{showProgress:()=>this.saveReorderLock=!0,hideProgress:()=>this.saveReorderLock=!1})}}getLiveLoadedCover(){var e=Object(y.domQuery)(".groups_edit_cover_wrap_live_upload",this.liveWrapEl);for(var t in e)if(e[t]){var i=e[t];if(Object(y.hasClass)(i,R))return i}return!1}getCoverPosition(e){var t=Object(y.domQuery)(".groups_edit_cover_wrap_live_upload",this.liveWrapEl);for(var i in t)if(t[i]){var o=t[i];if(e&&Object(y.domData)(o,"cover-id")==e)return parseInt(i)+1}return!1}getCoverWrapByCoverId(e){var t=Object(y.domQuery)(".groups_edit_cover_wrap_live_upload",this.box.bodyNode);for(var i in t)if(t[i]){var o=t[i];if(Object(y.domData)(o,"cover-id")==e)return o}return!1}getNearestLiveCover(e){isUndefined(e)&&(e=0);var t=Object(y.domQuery)(".groups_edit_cover_wrap_live_upload:not(.edit)",this.box.bodyNode);return!!t[e]&&t[e]}onUploadErrorLiveCover(e,t){if(!t){var i=this.getLiveLoadedCover();Object(y.removeClass)(i,R),Object(y.removeClass)(i,"disabled")}return showFastBox(getLang("global_error"),e)}onDidUploadedLiveCover(e){var t,i=e.story.preview;t=this.reUploadCoverId?this.getCoverWrapByCoverId(this.reUploadCoverId):this.getNearestLiveCover();var o=Object(y.geByTag1)("img",t);(attr(o,"src",i),Object(y.removeClass)(t,R),Object(y.addClass)(t,"edit"),e.story.isVideo)?(Object(y.addClass)(t,"video"),Object(y.removeClass)(t,"photo"),Object(y.geByClass1)("page_cover_action",Object(y.geByClass1)("video_size",t)).innerHTML=e.story.videoDuration):(Object(y.removeClass)(t,"video"),Object(y.addClass)(t,"photo"));if(Object(y.addClass)(t,"edit"),Object(y.domData)(t,"cover-id",e.storyRaw),Object(y.domData)(Object(y.geByClass1)("upload",t),"cover-id",e.storyRaw),Object(y.domData)(Object(y.geByClass1)("delete",t),"cover-id",e.storyRaw),!this.reUploadCoverId){var r=t.cloneNode(!0);re(t),this.liveWrapToDrag.appendChild(r),t=this.getNearestLiveCover(),Object(y.removeClass)(t,"disabled"),this.uploading=!1,this.uploadLive.setCurFilesCount(this.getLiveCoversCount()),this.initSorter()}this.reUploadCoverId=0,this.initLiveCoverEvents()}onUploadStartLiveCover(e){var t;this.reUploadCoverId?(t=this.getCoverWrapByCoverId(this.reUploadCoverId),Object(y.removeClass)(t,"edit")):t=this.getNearestLiveCover(e),Object(y.removeClass)(t,"disabled"),Object(y.addClass)(t,R)}dragDidEnter(e){return e.dataTransfer&&(e.dataTransfer.items&&e.dataTransfer.items.length>0&&"file"===e.dataTransfer.items[0].kind||e.dataTransfer.types&&e.dataTransfer.types.indexOf("Files")>-1)&&(clearTimeout(this.DragLeaveTimer),Object(y.addClass)(this.liveWrapEl,"drop")),Object(r.cancelEvent)(e)}dragDidLeave(e){return clearTimeout(this.DragLeaveTimer),this.DragLeaveTimer=setTimeout(()=>{Object(y.removeClass)(this.liveWrapEl,"drop")},100),Object(r.cancelEvent)(e)}dragDidDrop(e){return this.dragDidLeave(e),e&&e.dataTransfer&&e.dataTransfer.files&&e.dataTransfer.files.length>0&&this.uploadLive.pushFiles(e.dataTransfer.files),Object(r.cancelEvent)(e)}getLiveCoversCount(){var e=Object(y.geByClass)("edit",Object(y.domQuery1)("#live_covers_to_drag",this.box.bodyNode)),t=0;return e&&(t=e.length),t}setScalable(e,t){this.saveScalableLock||(this.saveScalableLock=!0,Object(n.checkbox)(e),ajax.post("groupsedit_cover.php",{act:"a_save_scalable",id:this.groupId,hash:t,scalable:Object(n.isChecked)(e)?1:0},{showProgress:()=>this.saveScalableLock=!0,hideProgress:()=>this.saveScalableLock=!1}))}}},128:function(e,t,i){e.exports=i("xubF")},"12ku":function(e,t,i){"use strict";i.r(t),i.d(t,"ON_BOARDING_BG_ID",function(){return a}),i.d(t,"ON_BOARDING_BG_HEADER_ID",function(){return d}),i.d(t,"ON_BOARDING_BG_RECT_ID",function(){return h}),i.d(t,"ON_BOARDING_BG_CLIP_ID",function(){return l}),i.d(t,"default",function(){return v});i("a1Th"),i("Btvt"),i("rE2o"),i("ioFf"),i("rGqo");var o=i("zxIV"),r=i("lXE5"),n=i("k3PD");function s(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var i=[],o=!0,r=!1,n=void 0;try{for(var s,a=e[Symbol.iterator]();!(o=(s=a.next()).done)&&(i.push(s.value),!t||i.length!==t);o=!0);}catch(e){r=!0,n=e}finally{try{o||null==a.return||a.return()}finally{if(r)throw n}}return i}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var a="onboarding_bg",d="onboarding_bg_header",h="onboarding_bg_rect",l="onboarding_bg_clip",c="page_header_cont",u="onboarding",p=42;class v{constructor(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];this.el=e,this.text=t,this.hideDarkness=!0,this.oldColor=!1;var o={autoShow:!1,noAutoHideOnWindowClick:!0,content:`${t}`,cls:"feature_intro_tt feature_intro_blue_tt tutorial_tip_tt",appendToParent:!0,onHide:this.ttOnHide.bind(this)};i.side&&(o.forceSide=i.side),i.offset&&(o.offset=i.offset),i.width&&(o.width=i.width),i.shift&&(o.centerShift=i.shift),i.border?this.border=i.border:this.border=[10,10,10,10],i.withCloseButton&&(o.withCloseButton=i.withCloseButton,o.onCloseButtonClick=i.onCloseButtonClick),this.ttParams=o,this.opts=i,this.initOnboardingBG()}initOnboardingBG(){if(!window.onboardingBG){var e=se('\n<div id="onboarding_layout">\n  <svg id="onboarding_bg_header" width="100%" height="42px">\n    <rect id="onboarding_bg_rect" x="0" y="0" width="100%" height="100%" fill-opacity="0.8" fill="#000"></rect>\n  </svg>\n  <svg id="onboarding_bg" width="100%" height="100%">\n  <defs>\n    <mask id="mask" x="0" y="0" width="100%" height="100%">\n      <rect x="0" y="0" width="100%" height="100%" fill="#fff"></rect>\n      <rect id="onboarding_bg_clip" x="0" y="0" width="0" height="0" fill="#000" rx="8" ry="8"></rect>\n    </mask>\n  </defs>\n  <rect id="onboarding_bg_rect" x="0" y="42" width="100%" height="100%" mask="url(#mask)" fill-opacity="0.8"></rect>\n  </svg>\n</div>\n      ');Object(o.domInsertBefore)(e,window.layerBG),window.onboardingBGHeader=ge(d),window.onboardingBG=ge(a),window.onboardingBGRect=ge(h),window.onboardingBGClip=ge(l),window.cur.destroy.push(()=>{hide(window.onboardingBG),hide(window.onboardingBGHeader),removeClass(ge(c),u),this.hideDarkness=!0,this.hideTT(),delete window.onboardingBG,delete window.onboardingBGHeader,delete window.onboardingBGRect,delete window.onboardingBGClip,this.opts.onBGClick&&removeEvent(window.onboardingBG,"click",this.opts.onBGClick)}),this.opts.onBGClick&&addEvent(window.onboardingBG,"click",this.opts.onBGClick)}}showTT(){var e=s(Object(o.getXY)(this.el),2)[1];this.tt=new window.ElementTooltip(this.el,this.ttParams),this.opts.highlight&&(this.addDarkness(),this.addHighlight()),this.tt.show();var t=this.tt.getContent();Object(n.isElementInViewport)(this.el)&&Object(n.isElementInViewport)(t)||Object(r.scrollToY)(e-p)}hideTT(){this.tt&&(this.tt.destroy(),this.removeDarkens(),this.hideDarkness&&(removeEvent(window,"scroll"),removeEvent(window,"resize")))}addHighlight(){window.onboardingBGClip&&(this.highlightElement(),addEvent(window,"scroll",this.onScrollTT.bind(this)),addEvent(window,"resize",this.onResizeTT.bind(this)))}highlightElement(){var e=this.el.offsetWidth,t=this.el.offsetHeight,i=Object(o.getXY)(this.el);attr(window.onboardingBGClip,"width",e+this.border[1]+this.border[3]),attr(window.onboardingBGClip,"height",t+this.border[0]+this.border[2]),attr(window.onboardingBGClip,"x",i[0]-this.border[1]),attr(window.onboardingBGClip,"y",i[1]-this.border[0])}onResizeTT(){this.setDartToFullWidth(),this.highlightElement()}onScrollTT(){var e=this.getPageHeight();window.onboardingBG.height!=e&&this.setDartToFullHeight()}setDartToFullHeight(){attr(window.onboardingBG,"height",this.getPageHeight())}setDartToFullWidth(){attr(window.onboardingBG,"width",this.getPageWidth()),attr(window.onboardingBGHeader,"width",this.getPageWidth())}addDarkness(){Object(o.isVisible)(window.onboardingBG)||(this.setDartToFullHeight(),this.setDartToFullWidth(),show(window.onboardingBG),Object(o.isVisible)(window.onboardingBGHeader)||(show(window.onboardingBGHeader),addClass(ge(c),u)))}removeDarkens(){this.hideDarkness&&(hide(window.onboardingBG),hide(window.onboardingBGHeader),removeClass(ge(c),u))}ttOnHide(){this.hideTT()}show(){setTimeout(this.showTT.bind(this),1e3)}getPageWidth(){var e=document.documentElement,t=document.body;return Math.max(t.scrollWidth,e.scrollWidth,t.offsetWidth,e.offsetWidth,t.clientWidth,e.clientWidth)}getPageHeight(){var e=document.documentElement,t=document.body;return Math.max(t.scrollHeight,e.scrollHeight,t.offsetHeight,e.offsetHeight,t.clientHeight,e.clientHeight)}}},Klmf:function(e,t,i){"use strict";i.r(t),i.d(t,"Events",function(){return o}),i.d(t,"UploaderEvents",function(){return r}),i.d(t,"Constants",function(){return n}),i.d(t,"UploadErrorTypes",function(){return s}),i.d(t,"UploadStoryState",function(){return a});var o={storyDidUploaded:"storyDidUploaded",storyDidUpload:"storyDidUpload",storyDidFailed:"storyDidFailed",storyDidRemove:"storyDidRemove",coverDidUploaded:"coverDidUploaded",coverDidUpload:"coverDidUpload",coverDidFailed:"coverDidFailed",pushUploadError:"pushUploadError"},r={didUploaded:"didUploaded",didDestroyed:"didDestroyed",didProgress:"didProgress",didUpload:"didUpload",didFailed:"didFailed",didRemove:"didRemove",uploadError:"uploadError"},n={maxTotalCount:50,uploadingMaxCount:2},s={unknown:1,securityError:2,internalError:3,noVideoStream:4,invalidVideoCodec:5,invalidAudioCodec:6,toLongStory:7,bigFile:8},a={waiting:"waiting",uploading:"uploading",finished:"finished",failed:"failed"}},Wr5T:function(e,t){!function(e,t){"use strict";if("IntersectionObserver"in e&&"IntersectionObserverEntry"in e&&"intersectionRatio"in e.IntersectionObserverEntry.prototype)"isIntersecting"in e.IntersectionObserverEntry.prototype||Object.defineProperty(e.IntersectionObserverEntry.prototype,"isIntersecting",{get:function(){return this.intersectionRatio>0}});else{var i=[];r.prototype.THROTTLE_TIMEOUT=100,r.prototype.POLL_INTERVAL=null,r.prototype.USE_MUTATION_OBSERVER=!0,r.prototype.observe=function(e){if(!this._observationTargets.some(function(t){return t.element==e})){if(!e||1!=e.nodeType)throw new Error("target must be an Element");this._registerInstance(),this._observationTargets.push({element:e,entry:null}),this._monitorIntersections(),this._checkForIntersections()}},r.prototype.unobserve=function(e){this._observationTargets=this._observationTargets.filter(function(t){return t.element!=e}),this._observationTargets.length||(this._unmonitorIntersections(),this._unregisterInstance())},r.prototype.disconnect=function(){this._observationTargets=[],this._unmonitorIntersections(),this._unregisterInstance()},r.prototype.takeRecords=function(){var e=this._queuedEntries.slice();return this._queuedEntries=[],e},r.prototype._initThresholds=function(e){var t=e||[0];return Array.isArray(t)||(t=[t]),t.sort().filter(function(e,t,i){if("number"!=typeof e||isNaN(e)||e<0||e>1)throw new Error("threshold must be a number between 0 and 1 inclusively");return e!==i[t-1]})},r.prototype._parseRootMargin=function(e){var t=(e||"0px").split(/\s+/).map(function(e){var t=/^(-?\d*\.?\d+)(px|%)$/.exec(e);if(!t)throw new Error("rootMargin must be specified in pixels or percent");return{value:parseFloat(t[1]),unit:t[2]}});return t[1]=t[1]||t[0],t[2]=t[2]||t[0],t[3]=t[3]||t[1],t},r.prototype._monitorIntersections=function(){this._monitoringIntersections||(this._monitoringIntersections=!0,this.POLL_INTERVAL?this._monitoringInterval=setInterval(this._checkForIntersections,this.POLL_INTERVAL):(n(e,"resize",this._checkForIntersections,!0),n(t,"scroll",this._checkForIntersections,!0),this.USE_MUTATION_OBSERVER&&"MutationObserver"in e&&(this._domObserver=new MutationObserver(this._checkForIntersections),this._domObserver.observe(t,{attributes:!0,childList:!0,characterData:!0,subtree:!0}))))},r.prototype._unmonitorIntersections=function(){this._monitoringIntersections&&(this._monitoringIntersections=!1,clearInterval(this._monitoringInterval),this._monitoringInterval=null,s(e,"resize",this._checkForIntersections,!0),s(t,"scroll",this._checkForIntersections,!0),this._domObserver&&(this._domObserver.disconnect(),this._domObserver=null))},r.prototype._checkForIntersections=function(){var t=this._rootIsInDom(),i=t?this._getRootRect():{top:0,bottom:0,left:0,right:0,width:0,height:0};this._observationTargets.forEach(function(r){var n=r.element,s=a(n),d=this._rootContainsTarget(n),h=r.entry,l=t&&d&&this._computeTargetAndRootIntersection(n,i),c=r.entry=new o({time:e.performance&&performance.now&&performance.now(),target:n,boundingClientRect:s,rootBounds:i,intersectionRect:l});h?t&&d?this._hasCrossedThreshold(h,c)&&this._queuedEntries.push(c):h&&h.isIntersecting&&this._queuedEntries.push(c):this._queuedEntries.push(c)},this),this._queuedEntries.length&&this._callback(this.takeRecords(),this)},r.prototype._computeTargetAndRootIntersection=function(i,o){if("none"!=e.getComputedStyle(i).display){for(var r,n,s,d,l,c,u,p,v=a(i),_=h(i),g=!1;!g;){var b=null,m=1==_.nodeType?e.getComputedStyle(_):{};if("none"==m.display)return;if(_==this.root||_==t?(g=!0,b=o):_!=t.body&&_!=t.documentElement&&"visible"!=m.overflow&&(b=a(_)),b&&(r=b,n=v,s=void 0,d=void 0,l=void 0,c=void 0,u=void 0,p=void 0,s=Math.max(r.top,n.top),d=Math.min(r.bottom,n.bottom),l=Math.max(r.left,n.left),c=Math.min(r.right,n.right),p=d-s,!(v=(u=c-l)>=0&&p>=0&&{top:s,bottom:d,left:l,right:c,width:u,height:p})))break;_=h(_)}return v}},r.prototype._getRootRect=function(){var e;if(this.root)e=a(this.root);else{var i=t.documentElement,o=t.body;e={top:0,left:0,right:i.clientWidth||o.clientWidth,width:i.clientWidth||o.clientWidth,bottom:i.clientHeight||o.clientHeight,height:i.clientHeight||o.clientHeight}}return this._expandRectByRootMargin(e)},r.prototype._expandRectByRootMargin=function(e){var t=this._rootMarginValues.map(function(t,i){return"px"==t.unit?t.value:t.value*(i%2?e.width:e.height)/100}),i={top:e.top-t[0],right:e.right+t[1],bottom:e.bottom+t[2],left:e.left-t[3]};return i.width=i.right-i.left,i.height=i.bottom-i.top,i},r.prototype._hasCrossedThreshold=function(e,t){var i=e&&e.isIntersecting?e.intersectionRatio||0:-1,o=t.isIntersecting?t.intersectionRatio||0:-1;if(i!==o)for(var r=0;r<this.thresholds.length;r++){var n=this.thresholds[r];if(n==i||n==o||n<i!=n<o)return!0}},r.prototype._rootIsInDom=function(){return!this.root||d(t,this.root)},r.prototype._rootContainsTarget=function(e){return d(this.root||t,e)},r.prototype._registerInstance=function(){i.indexOf(this)<0&&i.push(this)},r.prototype._unregisterInstance=function(){var e=i.indexOf(this);-1!=e&&i.splice(e,1)},e.IntersectionObserver=r,e.IntersectionObserverEntry=o}function o(e){this.time=e.time,this.target=e.target,this.rootBounds=e.rootBounds,this.boundingClientRect=e.boundingClientRect,this.intersectionRect=e.intersectionRect||{top:0,bottom:0,left:0,right:0,width:0,height:0},this.isIntersecting=!!e.intersectionRect;var t=this.boundingClientRect,i=t.width*t.height,o=this.intersectionRect,r=o.width*o.height;this.intersectionRatio=i?Number((r/i).toFixed(4)):this.isIntersecting?1:0}function r(e,t){var i,o,r,n=t||{};if("function"!=typeof e)throw new Error("callback must be a function");if(n.root&&1!=n.root.nodeType)throw new Error("root must be an Element");this._checkForIntersections=(i=this._checkForIntersections.bind(this),o=this.THROTTLE_TIMEOUT,r=null,function(){r||(r=setTimeout(function(){i(),r=null},o))}),this._callback=e,this._observationTargets=[],this._queuedEntries=[],this._rootMarginValues=this._parseRootMargin(n.rootMargin),this.thresholds=this._initThresholds(n.threshold),this.root=n.root||null,this.rootMargin=this._rootMarginValues.map(function(e){return e.value+e.unit}).join(" ")}function n(e,t,i,o){"function"==typeof e.addEventListener?e.addEventListener(t,i,o||!1):"function"==typeof e.attachEvent&&e.attachEvent("on"+t,i)}function s(e,t,i,o){"function"==typeof e.removeEventListener?e.removeEventListener(t,i,o||!1):"function"==typeof e.detatchEvent&&e.detatchEvent("on"+t,i)}function a(e){var t;try{t=e.getBoundingClientRect()}catch(e){}return t?(t.width&&t.height||(t={top:t.top,right:t.right,bottom:t.bottom,left:t.left,width:t.right-t.left,height:t.bottom-t.top}),t):{top:0,bottom:0,left:0,right:0,width:0,height:0}}function d(e,t){for(var i=t;i;){if(i==e)return!0;i=h(i)}return!1}function h(e){var t=e.parentNode;return t&&11==t.nodeType&&t.host?t.host:t}}(window,document)},k3PD:function(e,t,i){"use strict";function o(e){var t=e.getBoundingClientRect();return t.top>=0&&t.left>=0&&t.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&t.right<=(window.innerWidth||document.documentElement.clientWidth)}i.r(t),i.d(t,"isElementInViewport",function(){return o})},nAFc:function(e,t,i){"use strict";i.r(t),i.d(t,"encodeHTMLEntities",function(){return a}),i.d(t,"escape",function(){return d}),i.d(t,"decodeHTMLEntities",function(){return h}),i.d(t,"prepareToWriting",function(){return l});i("a1Th"),i("Btvt"),i("rE2o"),i("ioFf"),i("rGqo"),i("Oyvg"),i("pIFo");var o=i("yqpO"),r=i("vkmG");function n(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var i=[],o=!0,r=!1,n=void 0;try{for(var s,a=e[Symbol.iterator]();!(o=(s=a.next()).done)&&(i.push(s.value),!t||i.length!==t);o=!0);}catch(e){r=!0,n=e}finally{try{o||null==a.return||a.return()}finally{if(r)throw n}}return i}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var s=r.symbols,a=r.encodeHTMLEntities,d=r.escape;function h(e){return s.reduce((e,t)=>{var i=n(t,2),o=i[0],r=i[1];return e.replace(new RegExp(o,"ig"),r)},e).replace(/&#(\d+);/g,(e,t)=>String.fromCodePoint(t))}function l(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=t.lineBreak,r=void 0!==i&&i,n=t.convertEmoji,s=void 0===n||n,a=h(e);return a=a.replace(/\n\r/gi,"\n"),"oneline"===r?a=a.replace(/<br>/gi," ").replace(/\n/gi," "):"html"===r&&(a=a.replace(/\n/gi,"<br>")),a=d(a),s&&(a=Object(o.emojiToHTML)(a,!0)),a}},o9iI:function(e,t,i){"use strict";function o(e,t){if(e&&e.sizes)return(e.sizes.filter(e=>{return e.type===t})[0]||{}).url}i.r(t),i.d(t,"getPhotoUrl",function(){return o})},xubF:function(e,t,i){"use strict";i.r(t);i("a1Th"),i("Btvt"),i("rE2o"),i("ioFf"),i("rGqo"),i("4+be");var o=i("zxIV"),r=i("Egk5"),n=i("t7n3"),s=(i("pIFo"),i("SRfc"),/^\+?[\d]{4,18}$/);var a=i("FWc3"),d=i("nAFc"),h="line_edit",l="line_div_value",c="line_div_icon",u="valid",p="onboarding_placeholder",v="line_value",_="empty";class g{constructor(e,t){this.base=e,this.el=t,this.elInput=geByClass1(l,t),this.elIcon=geByClass1(c,t),this.elLine=geByClass1(v,t),this.hideHash=Object(o.domData)(t,"hide-hash"),this.saveHash=Object(o.domData)(t,"save-hash"),this.validateHash=Object(o.domData)(t,"validate-hash"),this.groupId=Object(o.domData)(t,"group-id"),this.type=Object(o.domData)(t,"type"),this.oldValue=Object(o.domData)(t,"raw-value"),this.validateValue="",this.validateText="",this.backValue="",this.oldValue||(Object(o.hasClass)(this.elInput,_)?this.oldValue="":this.oldValue=Object(o.val)(this.elInput)),Object(r.addEvent)(this.elLine,"click",this.enableInput.bind(this)),Object(r.addEvent)(this.elIcon,"mouseover",this.onOverIcon.bind(this)),Object(r.addEvent)(this.elIcon,"click",this.onClickIcon.bind(this)),this.setValid(!0)}enableInput(e){if(this.hideValidateHint(),"a"===ge(e.target).tagName.toLowerCase())return!0;if(Object(o.hasClass)(this.elLine,h))return!1;var t=geByClass1("wall_post_more",this.elInput);return t&&t.click(),Object(o.hasClass)(this.elInput,_)?this.backValue="":this.backValue=Object(o.val)(this.elInput),this.base.resetInlineElements(this.el),this.oldValue?Object(o.val)(this.elInput,this.oldValue):Object(o.val)(this.elInput,this.backValue),this.validateValue="",this.extractA(this.elLine),Object(o.addClass)(this.elLine,h),Object(o.removeClass)(this.elInput,_),attr(this.elInput,"contenteditable",!0),Object(o.elfocus)(this.elInput,Object(o.val)(this.elInput).length),Object(r.addEvent)(this.elInput,"keyup",this.onKeyUp.bind(this)),Object(r.addEvent)(this.elInput,"keydown",this.onKeyDown.bind(this)),Object(r.addEvent)(this.elInput,"paste",this.onPaste.bind(this)),!1}disableInput(e,t,i){if(Object(o.hasClass)(this.elLine,h)){if(this.hideValidateHint(),Object(o.hasClass)(this.elIcon,u)||i){var s=this.oldValue;if(Object(n.isUndefined)(e)||(s=e,this.formattedValue=e),t?(Object(o.domData)(this.el,"raw-value",t),this.oldValue=t):(Object(o.domData)(this.el,"raw-value",s),this.oldValue=s),s){if("group_phone"==this.type){var a=this.formattedValue?this.formattedValue:s;s=`<a href='tel:${a}'>${a}</a>`}else if("group_website"==this.type){var d=`/away.php?to=${s}`;s=`<a href='${d=d.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/\'/g,"&#39;")}' target='_blank' ref='noopener'>${s}</a>`}else"group_description"==this.type&&"<br>"==s&&(s="");Object(o.val)(this.elInput,s),Object(o.addClass)(this.elIcon,"edit")}else Object(o.val)(this.elInput,s),Object(o.removeClass)(this.elIcon,"edit")}else Object(o.val)(this.elInput,this.backValue),Object(o.removeClass)(this.elIcon,"edit");Object(o.removeClass)(this.elLine,h),attr(this.elInput,"contenteditable",!1);var l=Object(o.val)(this.elInput);browser.msie_edge&&(l=this.cleanBR(l)),0==l.length&&(Object(o.addClass)(this.elInput,_),Object(o.val)(this.elInput,attr(this.elInput,"placeholder"))),Object(r.removeEvent)(this.elInput,"keyup keydown paste"),window.getSelection().removeAllRanges()}}showValidateHint(){this.validateText&&Object(a.showHint)(this.elIcon,{text:this.validateText,maxWidth:242})}hideValidateHint(){window.tooltips&&window.tooltips.hideAll()}onOverIcon(e){if(Object(o.hasClass)(this.elLine,h))Object(o.hasClass)(this.elIcon,u)||this.showValidateHint();else{var t="";t=Object(o.hasClass)(this.elIcon,"edit")?getLang("groups_info_placeholder_edit_tt"):getLang("groups_info_placeholder_hide_tt"),Object(a.showTitle)(this.elIcon,t,[7,7])}}onClickIcon(e){if(Object(o.hasClass)(this.elLine,h)){if(!Object(o.hasClass)(this.elIcon,u))return!1;this.save(e)}else Object(o.hasClass)(this.elIcon,"edit")||this.hide(e);this.hideValidateHint()}onKeyUp(e){this.hideValidateHint(),"<br>"===this.elInput.innerHTML&&(this.elInput.innerHTML="",this.elInput.display="none",this.elInput.offsetHeight,this.elInput.style.display=""),this.validate(!0)}onPaste(e){return Object(r.cancelEvent)(e),Emoji.onEditablePaste(this.elInput,{},0,e),!0}cleanBR(e){return"<br>"===e?"":e}onKeyDown(e){if(this.hideValidateHint(),e.keyCode===KEY.ESC)this.disableInput(),Object(r.cancelEvent)(e);else{(Object(o.hasClass)(e.target,"text")?10===e.keyCode||e.keyCode===KEY.ENTER:10===e.keyCode||e.keyCode===KEY.ENTER&&(e.ctrlKey||e.metaKey&&browser.mac))&&(this.save(),Object(r.cancelEvent)(e))}}validatePhone(e,t,i,o){this.validateTimeout&&(this.validateTimeout=!1);var r=this;this.validateTimeout=setTimeout(function(){var n={act:"a_validate_info_from_inline",id:t,hash:o,type:i,value:e};ajax.post("groupsedit_onboarding.php",n,{onDone:function(e){e.valid?(e.raw_value.startsWith("8800")||(e.raw_value="+"+e.raw_value),r.setValid(!0,"",e.value,e.raw_value)):r.setValid(!1,getLang("groups_inline_validation_error_not_valid_phone"))}})},1e3)}removeSpans(e){for(var t=e.getElementsByTagName("span"),i=0;i<t.length;i++)t[i].outerHTML=t[i].innerHTML}extractA(e){for(var t=e.getElementsByTagName("a");t.length;){for(var i=t[0].parentNode;t[0].firstChild;)i.insertBefore(t[0].firstChild,t[0]);i.removeChild(t[0])}}validate(e){this.hideValidateHint(),this.removeSpans(this.elInput);var t=Object(o.val)(this.elInput);browser.msie_edge&&(t=this.cleanBR(t));var i,r=!0;t!=this.oldValue?"group_description"==this.type?(r=t.length<4e3,this.setValid(r,"",t)):"group_phone"==this.type?t.length>0?(i=t,i=trim(i),(r=Boolean(i.match(s)))?!Object(n.isUndefined)(e)&&e?(this.setValid(!1),this.validatePhone(t,this.groupId,this.type,this.validateHash)):this.setValid(!0):this.setValid(!1,getLang("groups_inline_validation_error_not_valid_phone"))):this.setValid(!0):"group_website"==this.type&&(r=t.length>=0&&t.length<100,this.setValid(r)):this.setValid(!1)}setValid(e,t,i,r){e&&!Object(o.hasClass)(this.elIcon,u)?Object(o.addClass)(this.elIcon,u):!e&&Object(o.hasClass)(this.elIcon,u)&&Object(o.removeClass)(this.elIcon,u),Object(n.isUndefined)(i)||(this.validateValue=i,this.validateRawValue=r),this.validateText="",e||(this.validateText=t||getLang("groups_info_inline_validation_error_default"))}hide(e){Object(r.cancelEvent)(e);var t={act:"a_hide_inline",id:this.groupId,hash:this.hideHash,type:this.type};return ajax.post("groupsedit_onboarding.php",t),Object(o.hasClass)(this.elInput,_)?this.removeEl():this.removeIcon(),!1}removeIcon(){this.elIcon.remove(),Object(o.removeClass)(this.el,p),this.disableInput()}removeEl(){var e=domPN(domPN(domPN(domPN(this.el))));(this.el.remove(),geByClass("ui_tab",e)<2)&&(geByClass1("group_info_row")||e.remove())}save(e){Object(r.cancelEvent)(e);var t=Object(o.val)(this.elInput);if(t==this.oldValue)return!1;var i=!Object(o.hasClass)(this.elIcon,u);browser.msie_edge&&(t=this.cleanBR(t));var n=this.clearVal(t);n=(n=Object(d.decodeHTMLEntities)(n)).replace(/&nbsp;/g," ");var s="group_description"===this.type||i,a=s&&window.GroupsAdminTips&&window.GroupsAdminTips.isShownSection()?1:0,h={act:"a_save_info_from_inline",id:this.groupId,hash:this.saveHash,type:this.type,value:n,update_admin_tips:a},l={};return s&&(l={onDone:this.onSaveDone.bind(this)}),ajax.post("groupsedit_onboarding.php",h,l),s||(this.validateValue?this.disableInput(this.validateValue,this.validateRawValue):this.disableInput(t)),!0}onSaveDone(e){if(e.valid){"group_phone"===this.type&&(e.raw_value.startsWith("8800")||(e.raw_value="+"+e.raw_value)),this.disableInput(e.value,e.raw_value,!0);var t=e.admin_tips_section,i=void 0===t?null:t;null!==i&&window.GroupsAdminTips&&window.GroupsAdminTips.refreshSection(i)}else"group_phone"===this.type?(this.setValid(!1,getLang("groups_inline_validation_error_not_valid_phone")),this.showValidateHint()):this.setValid(!1)}clearVal(e){return e.replace(/<br\s*[\/]?>/gi,"\n").replace(/<div>/gi,"\n").replace(/<div style="" class="" id="">/gi,"\n").replace(/<\/div>/gi,"")}}var b=i("12ku"),m=i("EasH"),f=i("E2g8").Promise,w="box";class O{constructor(e,t,i,o){this.hash=i,this.groupId=t,this.steps=[],this.stepsElements={},this.curStepId=0,this.confirmBox=null,this.lastTrack=f.resolve();var r=""!==o&&o!==w;Object.keys(e).forEach(t=>{var i=e[t];i&&(r?(i.step===o&&(r=!1),this.steps.push(null)):ge(i.el)&&this.steps.push(i))});var n=this.steps.length;Object.keys(this.steps).forEach(e=>{var t=this.steps[e];if(t){var i={highlight:!0};t.side&&(i.side=t.side),t.offset&&(i.offset=t.offset),t.width&&(i.width=t.width),t.shift&&(i.shift=t.shift),t.border&&(i.border=t.border);var o=getLang(t.text),r=Number(e)+1,s=langStr(getLang("groups_onboarding_tutor_progress"),"step",r,"total_steps",n),a=`<span class="feature_intro_tt_hide" onclick="window.GroupsOnboarding.tutorial.hide()">&nbsp;</span><div class="step_text">${o}</div>\n        <div><span class="flat_button further_button" onclick="window.GroupsOnboarding.tutorial.nextStep()">${getLang(n>r?"groups_onboarding_tutor_further":"groups_onboarding_tutor_done")}</span>\n        <span class="step_progress">${s}</span>\n        </div>\n        `,d=new b.default(ge(t.el),a,i);this.stepsElements[Number(e)]=d}else++this.curStepId}),this.onDocumentMouseDown=this.onDocumentMouseDown.bind(this)}showWelcomeBox(e){var t={act:"welcome_box",group_id:this.groupId},i={containerClass:"groups_welcome_box",params:{hideButtons:!0,width:638,onBeforeHide:()=>{Object(r.addEvent)(window.boxLayerWrap,"click",window.__bq.hideLastCheck)}},onDone:(e,t)=>{removeEvent(window.boxLayerWrap,"click",window.__bq.hideLastCheck)}};this.welcomeBox=Object(m.showBox)("al_groups.php",t,i)}hideWelcomeBox(e){this.welcomeBox&&(this.welcomeBox.hide(),this.track("box"),e||this.track("hide"))}start(){this.hideWelcomeBox(!0),this.showStep(),Object(r.addEvent)(document,"mousedown",this.onDocumentMouseDown)}onDocumentMouseDown(e){var t=ge(e.target);if(t&&t.id===b.ON_BOARDING_BG_RECT_ID){var i=geByClass1("further_button");Object(o.addClass)(i,"outline"),setTimeout(function(){Object(o.removeClass)(i,"outline")},500)}}showStep(){this.stepsElements[this.curStepId]&&this.step(this.curStepId)}nextStep(){this.track(this.steps[this.curStepId].step);var e=this.curStepId+1;this.stepsElements[e]?(this.curStepId++,this.curStepElement.hideDarkness=!1,this.curStepElement.tt.hide(),this.step(e)):(this.track("success"),this.hideOnEnd())}step(e){this.curStepElement=this.stepsElements[e],this.curStepElement.showTT()}track(e){this.lastTrack=this.lastTrack.then(()=>new f(t=>{var i={act:"a_onboarding_tutorial_track",step:e,id:this.groupId,hash:this.hash};ajax.post("groupsedit_onboarding.php",i,{onDone:t})}))}hide(e){if(!e){var t={title:getLang("groups_onboarding_tutor_hide_title"),noCloseButton:!0,onHide:this.onConfirmBoxNo.bind(this)};return this.curStepElement.removeDarkens(),this.confirmBox=showFastBox(t,getLang("groups_onboarding_tutor_hide"),getLang("global_yes"),this.onConfirmBoxYes.bind(this),getLang("global_cancel"),this.onConfirmBoxNo.bind(this)),void Object(o.addClass)(window.boxLayerBG,"onboarding_bg")}this.hideOnEnd()}onConfirmBoxNo(){Object(o.removeClass)(window.boxLayerBG,"onboarding_bg"),this.confirmBox.hide(),this.curStepElement.addDarkness()}onConfirmBoxYes(){Object(o.removeClass)(window.boxLayerBG,"onboarding_bg"),this.confirmBox.hide(),this.hide(!0),this.track("hide")}hideOnEnd(){this.curStepElement.tt.hide(),removeEvent(document,"mousedown",this.onDocumentMouseDown)}}var E=i("3F7q"),y=i("v+DW");function C(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var i=[],o=!0,r=!1,n=void 0;try{for(var s,a=e[Symbol.iterator]();!(o=(s=a.next()).done)&&(i.push(s.value),!t||i.length!==t);o=!0);}catch(e){r=!0,n=e}finally{try{o||null==a.return||a.return()}finally{if(r)throw n}}return i}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}i("91GP"),i("hhXQ"),i("Wr5T");var j=i("k487"),I=i("k3PD"),T=i("lXE5"),D=i("BJj/"),k=i("kHqu");function S(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var i=[],o=!0,r=!1,n=void 0;try{for(var s,a=e[Symbol.iterator]();!(o=(s=a.next()).done)&&(i.push(s.value),!t||i.length!==t);o=!0);}catch(e){r=!0,n=e}finally{try{o||null==a.return||a.return()}finally{if(r)throw n}}return i}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function x(){return(x=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(e[o]=i[o])}return e}).apply(this,arguments)}var L="group_admin_tips_reset_new",B="group_admin_tips_hide_item",R="group_admin_tips_hide_section",U="group_admin_tips_reset",M="group_admin_tips_stat",P=1,N=2,A="item",H="section",V=5e3,G=2e3;class F{static get ITEM_LOAD_AVATAR(){return"load_avatar"}static get ITEM_DESCRIPTION(){return"description"}static get ITEM_MESSAGES(){return"messages"}static get ITEM_LEFT_LINK(){return"left_link"}static get ITEM_SHORT_URL(){return"short_url"}static get ITEM_MAKE_POST(){return"make_post"}static get ITEM_COMMENTS_FILTER(){return"comments_filter"}static get ITEM_CREATE_DISCUSSION(){return"create_discussion"}static get ITEM_ADDRESS(){return"address"}static get ITEM_ACTION_BUTTON(){return"action_button"}static get ITEM_MARKET_ITEM(){return"market_item"}static init(e,t){if(function(){var e=nav.objLoc.hasOwnProperty("admin_tip");e&&delete nav.objLoc.admin_tip;var t=nav.objLoc.hasOwnProperty("act")&&"group_section_admin_tips"===nav.objLoc.act&&nav.objLoc.hasOwnProperty("from");t&&delete nav.objLoc.from;(e||t)&&nav.setLoc(nav.objLoc)}(),"show"!==t){Y("isModer",e);var i=window.cur,n=i.group_id,s=i.groups_admin_tips_stat;Y("groupId",n),Y("stat",s);var a={},d={};Y("statQueue",a),Y("statSent",d),Y("currentTip",null),Y("sendStatQuery",Object(D.debounce)(()=>Q(a,d,n,s),V)),Y("itemsViewingTimeouts",{}),Y("observers",[]);var h=Object(o.ge)("ui_admin_tips_load_more"),l=e=>{Object(r.checkEvent)(e)||(q(),Q(a,d,n,s))};h&&Object(r.addEvent)(h,"click",l),window.cur.destroy.push(function(){z(),K(),h&&removeEvent(h,"click",l)}),$()}}static showItem(e,t){var i=function(e){var t=null;switch(e){case F.ITEM_LOAD_AVATAR:t={element:Object(o.ge)("page_avatar_wrap"),appendTo:Object(o.ge)("narrow_column"),offset:[16,16],width:190};break;case F.ITEM_DESCRIPTION:t={element:Object(o.ge)("group_edit_desc"),appendTo:Object(o.ge)("wide_column"),forceSide:"bottom",offset:[0,-8]};break;case F.ITEM_MESSAGES:var i=Object(o.domQuery1)("#group_edit_row_messages .group_edit_labeled");t={element:i,appendTo:Object(o.ge)("wide_column"),forceSide:"bottom",offset:[0,1]};break;case F.ITEM_LEFT_LINK:var r=Object(o.ge)("page_menu_group_more");if(!r)return null;Page.showMoreActions(r),t={element:Object(o.ge)("page_menu_group_left_menu"),appendTo:Object(o.ge)("narrow_column"),offset:[32,16],width:240};break;case F.ITEM_SHORT_URL:t={element:Object(o.ge)("group_edit_addr_table"),appendTo:Object(o.ge)("wide_column"),forceSide:"bottom",offset:[0,-8]};break;case F.ITEM_MAKE_POST:t={element:Object(o.ge)("submit_post_box"),appendTo:Object(o.ge)("wide_column"),forceSide:"bottom",offset:[0,-8]};break;case F.ITEM_COMMENTS_FILTER:t={element:Object(o.ge)("group_edit_obscene_wrap"),forceSide:"bottom",offset:[0,-8]};break;case F.ITEM_CREATE_DISCUSSION:t={disableTooltip:!0};break;case F.ITEM_ADDRESS:window.hasOwnProperty("GeAddresses")&&window.GeAddresses.toggleAddressesBlock(1),t={element:Object(o.ge)("groups_new_addresses_new"),forceSide:"bottom",offset:[0,-8],appendTo:Object(o.ge)("wide_column")};break;case F.ITEM_ACTION_BUTTON:t={element:Object(o.ge)("groups_edit_g_cta_button"),forceSide:"bottom",offset:[0,-8],appendTo:Object(o.ge)("wide_column")};break;case F.ITEM_MARKET_ITEM:t={element:Object(o.ge)("enable_market"),forceSide:"bottom",offset:[0,-8],appendTo:Object(o.ge)("wide_column")}}return t}(e);return!!i&&(!(!i.disableTooltip&&!function(e){var t=e.type,i=e.text,n=e.element,s=e.appendTo,a=void 0===s?null:s,d=e.forceSide,h=void 0===d?"left":d,l=e.offset,c=void 0===l?[0,0]:l,u=e.width,p=void 0===u?null:u;if(!n)return!1;if(!a){var v=Object(o.ge)("page_wrap");a=v||n}var _="bottom"===h?j.default.ALIGN_LEFT:j.default.ALIGN_CENTER,g=new j.default(n,{autoShow:!1,appendTo:a,offset:c,content:`<div class="group_edit_admin_tip_show_container">${i}</div>`,type:j.default.TYPE_VERTICAL,onHide:()=>{z()},cls:"feature_intro_tt feature_intro_blue_tt group_edit_admin_tip_show group_edit_admin_tip_show_"+t,forceSide:h,align:_,width:p}),b=0;if(!Object(I.isElementInViewport)(n)){var m=S(Object(o.getXY)(n),2)[1],f=Object(o.getH)(n);b=400,Object(T.scrollToY)(m-f,b)}g&&setTimeout(()=>{g.show(),Object(r.addEvent)(document,"mousedown click",z)},b);return Y("currentTip",g),!0}(x({type:e,text:t},i)))&&!i.disableTooltip)}static hideItem(e,t,i,s){if(Object(r.stopEvent)(s),!J("isModer")){var a={id:cur.group_id,type:e,hash:t,act:B,in_admin:i};ajax.post("groupsedit.php",a,{onDone(t){var r=t.result,s=t.html;if(r){if(Object(n.isString)(s))if(i){var a=Object(o.ge)("group_edit_admin_tips_counter");a&&s.length&&Object(o.domReplaceEl)(a,Object(n.unclean)(s))}else F.refreshSection(s),K(),$();else i||K();if(i){var d=X(e),h=Object(o.domPN)(Object(o.domPN)(Object(o.domPN)(d)));if(d)Object(o.re)(d),q(J("itemsViewingTimeouts"),e),Object(o.geByClass)("group_edit_admin_tips_item",h).length||Object(o.re)(h),l=J("groupId"),Object(k.globalHistoryDestroy)(nav.objLoc[0]),l&&(Object(k.globalHistoryDestroy)("club"+l),Object(k.globalHistoryDestroy)("event"+l),Object(k.globalHistoryDestroy)("public"+l))}var l}}})}}static isShownItem(e){return!!X(e)}static isShownSection(){return!!Object(o.ge)("admin_tips")}static refreshSection(e){if(Object(n.isString)(e)){var t=Object(o.ge)("page_block_group_admin_tips");t&&(e.length?Object(o.domReplaceEl)(t,Object(n.unclean)(e)):Object(o.re)(t))}}static hideSection(e,t,i){if(Object(r.stopEvent)(i),!J("isModer")){var n={id:cur.group_id,hash:e,value:t,act:R},s=Object(o.ge)("page_block_group_admin_tips"),a=Object(o.ge)("page_block_group_admin_tips_cancel");t?(addClass(s,"unshown"),removeClass(a,"unshown")):(addClass(a,"unshown"),removeClass(s,"unshown")),ajax.post("groupsedit.php",n,{onFail(){t?(addClass(a,"unshown"),removeClass(s,"unshown")):(addClass(s,"unshown"),removeClass(a,"unshown"))}})}}static onItemClick(e,t,i,o,n,s,a){W(P,A,{in_admin:s,type:t}),W(N,A,{in_admin:s,type:t}),o&&function(e,t){var i=window.cur.group_id;ajax.post("groupsedit.php",{id:i,type:e,hash:t,act:L,onDone(){var t=X(e);t&&removeClass(t,"group_edit_admin_tips_item_new")}})}(t,n);var d=X(t);return(d?Number(attr(d,"data-is-completed-on-click")):0)&&function(e,t){t?(removeClass(e,"group_edit_admin_tips_item_not_completed"),addClass(e,"group_edit_admin_tips_item_completed")):(removeClass(e,"group_edit_admin_tips_item_completed"),addClass(e,"group_edit_admin_tips_item_not_completed"))}(d,!0),F.showItem(t,i)?(Object(r.stopEvent)(a),!0):(Object(r.checkEvent)(a)?window.open(e,"_blank"):(q(),Q(),nav.go(e)),Object(r.stopEvent)(a),!0)}static reset(e,t){Object(r.stopEvent)(t);var i={id:cur.group_id,hash:e,act:U};ajax.post("groupsedit.php",i,{onDone(){nav.reload()}})}}function W(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=t+"_"+e;i.hasOwnProperty("type")&&(r+="_"+i.type);var n=J("statSent");n&&n.hasOwnProperty(r)||(J("statQueue")[r]={event_type:e,target:t,data:JSON.stringify(i)},o?Q():J("sendStatQuery")())}function Q(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:J("statQueue"),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:J("statSent"),i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:J("groupId"),o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:J("stat");if(!e||!Object.keys(e).length)return!0;var r={id:i,hash:o,act:M,items:JSON.stringify(Object.values(e))};ajax.post("groupsedit.php",r),Object.keys(e).forEach(i=>{t[i]=!0,delete e[i]})}function z(){var e=J("currentTip");e&&(e.hide(),e.destroy(),removeEvent(document,"mousedown click",z),Y("currentTip",null))}function $(){if(!J("isModer")&&"IntersectionObserver"in window){var e=J("observers"),t=Object(o.ge)("page_block_group_admin_tips"),i=t?0:1,r=function(e){var t=J("itemsViewingTimeouts");return(i,o)=>{i.forEach(i=>{var r=i.target,n=attr(r,"data-type"),s="section"===n?.8:1;if(i.intersectionRatio>=s){if(t&&t.hasOwnProperty(n)&&t[n])return;t[n]=setTimeout(()=>{o.unobserve(r),"section"===n?W(P,H):W(P,A,{in_admin:e,type:n}),q(t,n)},G)}else q(t,n)})}}(i);if(t&&!t.firstElementChild){var n=new IntersectionObserver(r,{threshold:[0,.8]});n.observe(t),e.push(n)}else{if(!i){var s=new IntersectionObserver(r,{threshold:[0,.8]});s.observe(t),e.push(s)}var a=Object(o.domQuery)(".group_edit_admin_tips_item.group_edit_admin_tips_item_not_completed");if(a.length){var d=new IntersectionObserver(r,{threshold:[0,1]});a.forEach(e=>{d.observe(e)}),e.push(d)}}}}function q(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:J("itemsViewingTimeouts"),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;null!=e&&(null!==t?e.hasOwnProperty(t)&&e[t]&&(clearTimeout(e[t]),delete e[t]):(Object.keys(e).forEach(t=>{clearTimeout(e[t])}),Y("itemsViewingTimeouts",{})))}function K(){if(!J("isModer")){var e=J("observers");null!=e&&(e.forEach(e=>{e.disconnect()}),Y("observers",[])),q()}}function Y(e,t){window.hasOwnProperty("cur")&&window.cur&&!window.cur.hasOwnProperty("admin_tips")&&(window.cur.admin_tips={}),window.cur.admin_tips[e]=t}function J(e){return window.hasOwnProperty("cur")&&window.cur&&window.cur.hasOwnProperty("admin_tips")&&window.cur.admin_tips.hasOwnProperty(e)?window.cur.admin_tips[e]:null}function X(e){return Object(o.ge)(`group_edit_admin_tips_item_${e}`)}var Z=i("0CRY");window.GroupsAdmins=new class{init(e){var t=e.admin_tips_available,i=e.admin_tips_mode,o=e.admin_tips_location;t&&(window.GroupsAdminTips=F,F.init(i,o)),e&&e.hasOwnProperty("chats_edit_available")&&e.chats_edit_available&&window.GeChats.init(e.chats_edit_options)}coverUploadBox(e){new Z.default(e).showBox()}},window.GroupsOnboarding=new class{constructor(){this.inlineElements=[],this.tutorial=!1}initInlineElements(){geByClass(p).forEach(e=>{if(Object(o.hasClass)(e,"address")){var t=Object(o.geByClass1)(c,e);Object(r.addEvent)(t,"click",i=>{Object(r.cancelEvent)(i),this.sendHide(e),Object(o.re)(t),Object(o.re)(e)})}else{Object(o.domData)(e,"type");var i=new g(this,e);this.inlineElements.push(i)}}),Object(r.addEvent)(window,"keydown",this.onWindowKeyDown.bind(this)),Object(r.addEvent)(document,"mousedown",this.onDocumentMouseDown.bind(this))}initTutorial(e,t,i,o){this.tutorial=new O(e,t,i,o),o?browser.chrome?setTimeout(()=>this.tutorial.showStep(),1e3):this.tutorial.showStep():this.tutorial.showWelcomeBox()}onWindowKeyDown(e){e.keyCode==KEY.ESC&&this.resetInlineElements()}onDocumentMouseDown(e){for(var t=e.target;t.parentNode;){if(Object(o.hasClass)(t,h))return!0;t=t.parentNode}return this.resetInlineElements(),!0}resetInlineElements(e){for(var t in this.inlineElements)if(this.inlineElements[t]){var i=this.inlineElements[t];e&&i==e||i.disableInput()}}showAddressBox(e,t){return new E.default(e,t,null,!0,function(e){var t=e.address_edit_html,i=e.address,r=e.admin_tips_section_html,s=Object(o.domQuery1)(".group_info_row.onboarding_placeholder.address"),a=C(Object(o.sech)(t),2),d=a[0],h=a[1],l=void 0===h?null:h;Object(o.domReplaceEl)(s,d),null!==l&&Object(o.domInsertAfter)(l,d),window.Addresses.initInfo(i),Object(n.isString)(r)&&window.hasOwnProperty("GroupsAdminTips")&&window.GroupsAdminTips.refreshSection(r)}).create(),!1}showMenuPlaceholder(e,t){return!Object(y.linkLocked)(e)&&(Object(r.cancelEvent)(t),this.sendHide(e,()=>{var e=Object(o.domQuery1)("#group_section_menu");e&&Object(o.removeClass)(e,"hided")},!0,!0),!1)}hideMenuPlaceholder(e,t){return!Object(y.linkLocked)(e)&&(Object(r.cancelEvent)(t),this.sendHide(e,()=>{var e=Object(o.domQuery1)("#group_section_menu");e&&Object(o.addClass)(e,"hided")},!0),!1)}sendHide(e,t,i,r){var s=Object(o.domData)(e,"hide-hash"),a={act:"a_hide_inline",id:Object(o.domData)(e,"group-id"),hash:s,type:Object(o.domData)(e,"type"),reset:r?1:0},d={onDone:!!Object(n.isFunction)(t)&&t,showProgress:!!i&&y.lockLink.pbind(e),hideProgress:!!i&&y.unlockLink.pbind(e)};ajax.post("groupsedit_onboarding.php",a,d)}};try{window.stManager.done(jsc("web/groups_admins.js"))}catch(e){}}});